(()=>{function e(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,a=new Array(t);n<t;n++)a[n]=e[n];return a}document.addEventListener("DOMContentLoaded",(function(){if(document.location.href.includes("plausible_analytics")){var t={nonceElem:document.getElementById("_wpnonce"),nonce:"",showWizardElem:document.getElementById("show_wizard"),domainNameElem:document.getElementById("domain_name"),apiTokenElem:document.getElementById("api_token"),createAPITokenElems:document.getElementsByClassName("plausible-create-api-token"),buttonElems:document.getElementsByClassName("plausible-analytics-button"),stepElems:document.getElementsByClassName("plausible-analytics-wizard-next-step"),init:function(){if(""===document.location.hash&&null!==document.getElementById("plausible-analytics-wizard")&&(document.location.hash="#welcome_slide"),null!==this.nonceElem&&(this.nonce=this.nonceElem.value),this.toggleWizardStep(),window.addEventListener("hashchange",this.toggleWizardStep),null!==this.showWizardElem&&this.showWizardElem.addEventListener("click",this.showWizard),null!==this.domainNameElem&&this.domainNameElem.addEventListener("keyup",this.disableConnectButton),null!==this.apiTokenElem&&this.apiTokenElem.addEventListener("keyup",this.disableConnectButton),this.createAPITokenElems.length>0)for(var e=0;e<this.createAPITokenElems.length;e++)this.createAPITokenElems[e].addEventListener("click",this.createAPIToken);if(this.buttonElems.length>0)for(var t=0;t<this.buttonElems.length;t++)this.buttonElems[t].addEventListener("click",this.saveOption);if(document.addEventListener("click",this.toggleOption),this.stepElems.length>0)for(var n=0;n<this.stepElems.length;n++)this.stepElems[n].addEventListener("click",this.saveOptionOnNext);this.showMessages()},toggleOption:function(e){if(null!==e.target.classList&&e.target.classList.contains("plausible-analytics-toggle")){var n,a,s=e.target.closest("button");n="submit"===e.target.type?s.querySelector("span"):e.target.closest("span"),s.classList.contains("bg-indigo-600")?(s.classList.replace("bg-indigo-600","bg-gray-200"),n.classList.replace("translate-x-5","translate-x-0"),a=""):(s.classList.replace("bg-gray-200","bg-indigo-600"),n.classList.replace("translate-x-0","translate-x-5"),a="on");var i=new FormData;i.append("action","plausible_analytics_toggle_option"),i.append("option_name",s.name),i.append("option_value",s.value),i.append("option_label",s.nextElementSibling.innerHTML),i.append("toggle_status",a),i.append("is_list",s.dataset.list),i.append("_nonce",t.nonce),t.ajax(i)}},saveOption:function(e){var n=e.target,a=n.closest(".plausible-analytics-section").querySelectorAll("input, textarea"),s=new FormData,i=[];a.forEach((function(e){i.push({name:e.name,value:e.value})})),s.append("action","plausible_analytics_save_options"),s.append("options",JSON.stringify(i)),s.append("_nonce",t.nonce),n.children.length>0&&n.children[0].classList.remove("hidden"),n.setAttribute("disabled","disabled"),t.ajax(s,n)},saveOptionOnNext:function(n){var a=document.location.hash.replace("#","");if("api_token_slide"===a||"domain_name_slide"===a){var s,i=[],o=function(t,n){var a="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!a){if(Array.isArray(t)||(a=function(t,n){if(t){if("string"==typeof t)return e(t,n);var a=Object.prototype.toString.call(t).slice(8,-1);return"Object"===a&&t.constructor&&(a=t.constructor.name),"Map"===a||"Set"===a?Array.from(t):"Arguments"===a||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(a)?e(t,n):void 0}}(t))||n&&t&&"number"==typeof t.length){a&&(t=a);var s=0,i=function(){};return{s:i,n:function(){return s>=t.length?{done:!0}:{done:!1,value:t[s++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,l=!0,c=!1;return{s:function(){a=a.call(t)},n:function(){var e=a.next();return l=e.done,e},e:function(e){c=!0,o=e},f:function(){try{l||null==a.return||a.return()}finally{if(c)throw o}}}}(n.target.closest(".plausible-analytics-wizard-step-section").getElementsByTagName("INPUT"));try{for(o.s();!(s=o.n()).done;){var l=s.value;i.push({name:l.name,value:l.value})}}catch(e){o.e(e)}finally{o.f()}var c=new FormData;c.append("action","plausible_analytics_save_options"),c.append("options",JSON.stringify(i)),c.append("_nonce",t.nonce),t.ajax(c).then((function(e){"api_token_slide"===a&&!0===e.success&&document.getElementById("enable_analytics_dashboard_view_stats_in_wordpress").removeAttribute("disabled")}))}},disableConnectButton:function(e){var t=e.target,n=document.getElementById("connect_plausible_analytics"),a=!1;if(null===n){var s=document.location.hash;n=document.querySelector(s+" .plausible-analytics-wizard-next-step"),a=!0}null!==n&&(""===t.value?a?(n.classList+=" pointer-events-none",n.classList.replace("bg-indigo-600","bg-gray-200")):(n.disabled=!0,n.innerHTML=n.innerHTML.replace("Connected","Connect")):a?(n.classList.remove("pointer-events-none"),n.classList.replace("bg-gray-200","bg-indigo-600")):n.disabled=!1)},createAPIToken:function(e){e.preventDefault();var t=document.getElementById("domain_name").value;t=t.replace("/","%2F"),window.open("".concat(plausible_analytics_hosted_domain,"/").concat(t,"/settings/integrations?new_token=WordPress"),"_blank","location=yes,height=768,width=1024,scrollbars=yes,status=no")},showWizard:function(e){var n=new FormData;n.append("action","plausible_analytics_show_wizard"),n.append("_nonce",e.target.dataset.nonce),t.ajax(n)},toggleWizardStep:function(){if(null!==document.getElementById("plausible-analytics-wizard")){for(var e=document.location.hash.substring(1).replace("_slide",""),t=document.querySelectorAll(".plausible-analytics-wizard-step"),n=document.querySelectorAll(".plausible-analytics-wizard-active-step"),a=document.querySelectorAll(".plausible-analytics-wizard-completed-step"),s=0;s<t.length;s++)t[s].classList.remove("hidden");for(var i=0;i<n.length;i++)n[i].classList+=" hidden";for(var o=0;o<a.length;o++)a[o].classList+=" hidden";var l=document.getElementById("active-step-"+e),c=document.getElementById("step-"+e);l.classList.remove("hidden"),c.classList+=" hidden";var d=l.dataset.completedSteps.split(",");(d=d.filter((function(e){return e}))).length<1||d.forEach((function(e){var t=document.getElementById("completed-step-"+e),n=document.getElementById("step-"+e);t.classList.remove("hidden"),n.classList+=" hidden"}))}},ajax:function(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,a=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];return fetch(ajaxurl,{method:"POST",body:e}).then((function(e){return n&&(n.children.length>0&&(n.children[0].classList+=" hidden"),"connect_plausible_analytics"===n.id&&200===e.status?n.innerText=plausible_analytics_i18n.connected:n.removeAttribute("disabled")),200===e.status&&e.json()})).then((function(e){!0===a&&t.showMessages();var n=new CustomEvent("plausibleAjaxDone",{detail:e});return document.dispatchEvent(n),void 0!==e.data?e.data:e}))},showMessages:function(){t.fetchMessages().then((function(e){!1!==e.error?t.showMessage(e.error,"error"):!1!==e.notice?t.showMessage(e.notice,"notice"):!1!==e.success&&t.showMessage(e.success,"success"),0!==e.additional.length&&null===document.getElementById("plausible-analytics-wizard")&&(void 0!==e.additional.id&&e.additional.message?t.showAdditionalMessage(e.additional.message,e.additional.id):void 0!==e.additional.id&&""===e.additional.message&&t.removeAdditionalMessage(e.additional.id))}))},fetchMessages:function(){var e=new FormData;return e.append("action","plausible_analytics_messages"),t.ajax(e,null,!1).then((function(e){return e}))},showMessage:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"success";"error"===t?(document.getElementById("icon-error").classList.remove("hidden"),document.getElementById("icon-success").classList.add("hidden"),document.getElementById("icon-notice").classList.add("hidden")):"notice"===t?(document.getElementById("icon-notice").classList.remove("hidden"),document.getElementById("icon-error").classList.add("hidden"),document.getElementById("icon-success").classList.add("hidden")):(document.getElementById("icon-success").classList.remove("hidden"),document.getElementById("icon-error").classList.add("hidden"),document.getElementById("icon-notice").classList.add("hidden"));var n=document.getElementById("plausible-analytics-notice");document.getElementById("plausible-analytics-notice-text").innerHTML=e,n.classList.remove("hidden"),setTimeout((function(){n.classList.replace("opacity-0","opacity-100")}),200),"error"!==t&&setTimeout((function(){n.classList.replace("opacity-100","opacity-0"),setTimeout((function(){n.classList+=" hidden"}),200)}),2e3)},showAdditionalMessage:function(e,t){document.querySelector("[name='".concat(t,"']")).closest(".plausible-analytics-group").innerHTML+=e},removeAdditionalMessage:function(e){var t,n=document.querySelector('[name="'.concat(e,'"]')).closest(".plausible-analytics-group");if(n.children.length>0)for(var a=0;a<n.children.length;a++)if(n.children[a].classList.contains("plausible-analytics-hook")){t=n.children[a];break}void 0!==t&&n.removeChild(t)}};t.init()}}))})();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoianMvcGxhdXNpYmxlLWFkbWluLmpzIiwibWFwcGluZ3MiOiJnSEFLQUEsU0FBU0MsaUJBQWlCLG9CQUFvQixXQUM3QyxHQUFLRCxTQUFTRSxTQUFTQyxLQUFLQyxTQUFTLHVCQUFyQyxDQUlBLElBQUlDLEVBQVksQ0FJZkMsVUFBV04sU0FBU08sZUFBZSxZQUNuQ0MsTUFBTyxHQUNQQyxlQUFnQlQsU0FBU08sZUFBZSxlQUN4Q0csZUFBZ0JWLFNBQVNPLGVBQWUsZUFDeENJLGFBQWNYLFNBQVNPLGVBQWUsYUFDdENLLG9CQUFxQlosU0FBU2EsdUJBQXVCLDhCQUNyREMsWUFBYWQsU0FBU2EsdUJBQXVCLDhCQUM3Q0UsVUFBV2YsU0FBU2EsdUJBQXVCLHdDQUszQ0csS0FBTSxXQXlCTCxHQXhCK0IsS0FBM0JoQixTQUFTRSxTQUFTZSxNQUF5RSxPQUExRGpCLFNBQVNPLGVBQWUsZ0NBQzVEUCxTQUFTRSxTQUFTZSxLQUFPLGtCQUdILE9BQW5CQyxLQUFLWixZQUNSWSxLQUFLVixNQUFRVSxLQUFLWixVQUFVYSxPQUc3QkQsS0FBS0UsbUJBRUxDLE9BQU9wQixpQkFBaUIsYUFBY2lCLEtBQUtFLGtCQUVmLE9BQXhCRixLQUFLVCxnQkFDUlMsS0FBS1QsZUFBZVIsaUJBQWlCLFFBQVNpQixLQUFLSSxZQUd4QixPQUF4QkosS0FBS1IsZ0JBQ1JRLEtBQUtSLGVBQWVULGlCQUFpQixRQUFTaUIsS0FBS0ssc0JBRzFCLE9BQXRCTCxLQUFLUCxjQUNSTyxLQUFLUCxhQUFhVixpQkFBaUIsUUFBU2lCLEtBQUtLLHNCQUc5Q0wsS0FBS04sb0JBQW9CWSxPQUFTLEVBQ3JDLElBQUssSUFBSUMsRUFBSSxFQUFHQSxFQUFJUCxLQUFLTixvQkFBb0JZLE9BQVFDLElBQ3BEUCxLQUFLTixvQkFBb0JhLEdBQUd4QixpQkFBaUIsUUFBU2lCLEtBQUtRLGdCQUk3RCxHQUFJUixLQUFLSixZQUFZVSxPQUFTLEVBQzdCLElBQUssSUFBSUMsRUFBSSxFQUFHQSxFQUFJUCxLQUFLSixZQUFZVSxPQUFRQyxJQUM1Q1AsS0FBS0osWUFBWVcsR0FBR3hCLGlCQUFpQixRQUFTaUIsS0FBS1MsWUFVckQsR0FGQTNCLFNBQVNDLGlCQUFpQixRQUFTaUIsS0FBS1UsY0FFcENWLEtBQUtILFVBQVVTLE9BQVMsRUFDM0IsSUFBSyxJQUFJQyxFQUFJLEVBQUdBLEVBQUlQLEtBQUtILFVBQVVTLE9BQVFDLElBQzFDUCxLQUFLSCxVQUFVVSxHQUFHeEIsaUJBQWlCLFFBQVNpQixLQUFLVyxrQkFPbkRYLEtBQUtZLGNBQ04sRUFPQUYsYUFBYyxTQUFVRyxHQUl2QixHQUEyQixPQUF2QkEsRUFBRUMsT0FBT0MsV0FBdUJGLEVBQUVDLE9BQU9DLFVBQVVDLFNBQVMsOEJBQWhFLENBSUEsSUFDSUMsRUFVQUMsRUFYRUMsRUFBU04sRUFBRUMsT0FBT00sUUFBUSxVQUsvQkgsRUFEcUIsV0FBbEJKLEVBQUVDLE9BQU9PLEtBQ0hGLEVBQU9HLGNBQWMsUUFHckJULEVBQUVDLE9BQU9NLFFBQVEsUUFLdkJELEVBQU9KLFVBQVVDLFNBQVMsa0JBRTdCRyxFQUFPSixVQUFVUSxRQUFRLGdCQUFpQixlQUMxQ04sRUFBT0YsVUFBVVEsUUFBUSxnQkFBaUIsaUJBQzFDTCxFQUFlLEtBR2ZDLEVBQU9KLFVBQVVRLFFBQVEsY0FBZSxpQkFDeENOLEVBQU9GLFVBQVVRLFFBQVEsZ0JBQWlCLGlCQUMxQ0wsRUFBZSxNQUdoQixJQUFNTSxFQUFPLElBQUlDLFNBQ2pCRCxFQUFLRSxPQUFPLFNBQVUscUNBQ3RCRixFQUFLRSxPQUFPLGNBQWVQLEVBQU9RLE1BQ2xDSCxFQUFLRSxPQUFPLGVBQWdCUCxFQUFPbEIsT0FDbkN1QixFQUFLRSxPQUFPLGVBQWdCUCxFQUFPUyxtQkFBbUJDLFdBQ3RETCxFQUFLRSxPQUFPLGdCQUFpQlIsR0FDN0JNLEVBQUtFLE9BQU8sVUFBV1AsRUFBT1csUUFBUUMsTUFDdENQLEVBQUtFLE9BQU8sU0FBVXZDLEVBQVVHLE9BRWhDSCxFQUFVNkMsS0FBS1IsRUFwQ2YsQ0FxQ0QsRUFPQWYsV0FBWSxTQUFVSSxHQUNyQixJQUFNTSxFQUFTTixFQUFFQyxPQUVYbUIsRUFEVWQsRUFBT0MsUUFBUSxnQ0FDUmMsaUJBQWlCLG1CQUNsQ1YsRUFBTyxJQUFJQyxTQUNYVSxFQUFVLEdBRWhCRixFQUFPRyxTQUFRLFNBQVVDLEdBQ3hCRixFQUFRRyxLQUFLLENBQUNYLEtBQU1VLEVBQU1WLEtBQU0xQixNQUFPb0MsRUFBTXBDLE9BQzlDLElBRUF1QixFQUFLRSxPQUFPLFNBQVUsb0NBQ3RCRixFQUFLRSxPQUFPLFVBQVdhLEtBQUtDLFVBQVVMLElBQ3RDWCxFQUFLRSxPQUFPLFNBQVV2QyxFQUFVRyxPQUU1QjZCLEVBQU9zQixTQUFTbkMsT0FBUyxHQUM1QmEsRUFBT3NCLFNBQVMsR0FBRzFCLFVBQVUyQixPQUFPLFVBR3JDdkIsRUFBT3dCLGFBQWEsV0FBWSxZQUVoQ3hELEVBQVU2QyxLQUFLUixFQUFNTCxFQUN0QixFQU9BUixpQkFBa0IsU0FBVUUsR0FDM0IsSUFBSWQsRUFBT2pCLFNBQVNFLFNBQVNlLEtBQUt3QixRQUFRLElBQUssSUFFL0MsR0FBYSxvQkFBVHhCLEdBQXVDLHNCQUFUQSxFQUFsQyxDQUlBLElBSXdCNkMsRUFGcEJULEVBQVUsR0FBR1UsRSwyNUJBQUFDLENBRk5qQyxFQUFFQyxPQUFPTSxRQUFRLDRDQUNWMkIscUJBQXFCLFVBR2YsSUFBeEIsSUFBQUYsRUFBQUcsTUFBQUosRUFBQUMsRUFBQUksS0FBQUMsTUFBMEIsS0FBakJiLEVBQUtPLEVBQUEzQyxNQUNia0MsRUFBUUcsS0FBSyxDQUFDWCxLQUFNVSxFQUFNVixLQUFNMUIsTUFBT29DLEVBQU1wQyxPQUM5QyxDQUFDLE9BQUFrRCxHQUFBTixFQUFBaEMsRUFBQXNDLEVBQUEsU0FBQU4sRUFBQU8sR0FBQSxDQUVELElBQUlDLEVBQU8sSUFBSTVCLFNBRWY0QixFQUFLM0IsT0FBTyxTQUFVLG9DQUN0QjJCLEVBQUszQixPQUFPLFVBQVdhLEtBQUtDLFVBQVVMLElBQ3RDa0IsRUFBSzNCLE9BQU8sU0FBVXZDLEVBQVVHLE9BRWhDSCxFQUFVNkMsS0FBS3FCLEdBQU1DLE1BQUssU0FBQUMsR0FJWixvQkFBVHhELElBQW1ELElBQXJCd0QsRUFBU0MsU0FDdkIxRSxTQUFTTyxlQUFlLHNEQUU5Qm9FLGdCQUFnQixXQUUvQixHQXpCQSxDQTBCRCxFQU9BcEQscUJBQXNCLFNBQVVRLEdBQy9CLElBQUlDLEVBQVNELEVBQUVDLE9BQ1hLLEVBQVNyQyxTQUFTTyxlQUFlLCtCQUNqQ3FFLEdBQWUsRUFFbkIsR0FBZSxPQUFYdkMsRUFBaUIsQ0FDcEIsSUFBSXdDLEVBQVc3RSxTQUFTRSxTQUFTZSxLQUNqQ29CLEVBQVNyQyxTQUFTd0MsY0FBY3FDLEVBQVcsMENBQzNDRCxHQUFlLENBQ2hCLENBRWUsT0FBWHZDLElBSWlCLEtBQWpCTCxFQUFPYixNQVdOeUQsR0FJSnZDLEVBQU9KLFdBQWEsdUJBQ3BCSSxFQUFPSixVQUFVUSxRQUFRLGdCQUFpQixpQkFKMUNKLEVBQU95QyxVQUFXLEVBQ2xCekMsRUFBT1UsVUFBWVYsRUFBT1UsVUFBVU4sUUFBUSxZQUFhLFlBWnBEbUMsR0FHSnZDLEVBQU9KLFVBQVUyQixPQUFPLHVCQUN4QnZCLEVBQU9KLFVBQVVRLFFBQVEsY0FBZSxrQkFIeENKLEVBQU95QyxVQUFXLEVBZ0JyQixFQU9BcEQsZUFBZ0IsU0FBVUssR0FDekJBLEVBQUVnRCxpQkFFRixJQUFJQyxFQUFTaEYsU0FBU08sZUFBZSxlQUFlWSxNQUNwRDZELEVBQVNBLEVBQU92QyxRQUFRLElBQUssT0FFN0JwQixPQUFPNEQsS0FBSyxHQUFEQyxPQUFJQyxrQ0FBaUMsS0FBQUQsT0FBSUYsRUFBTSw4Q0FBOEMsU0FBVSw4REFDbkgsRUFPQTFELFdBQVksU0FBVVMsR0FDckIsSUFBSXdDLEVBQU8sSUFBSTVCLFNBQ2Y0QixFQUFLM0IsT0FBTyxTQUFVLG1DQUN0QjJCLEVBQUszQixPQUFPLFNBQVViLEVBQUVDLE9BQU9nQixRQUFReEMsT0FFdkNILEVBQVU2QyxLQUFLcUIsRUFDaEIsRUFLQW5ELGlCQUFrQixXQUNqQixHQUE4RCxPQUExRHBCLFNBQVNPLGVBQWUsOEJBQTVCLENBYUEsSUFUQSxJQUFNVSxFQUFPakIsU0FBU0UsU0FBU2UsS0FBS21FLFVBQVUsR0FBRzNDLFFBQVEsU0FBVSxJQUsvRDRDLEVBQVdyRixTQUFTb0QsaUJBQWlCLG9DQUNyQ2tDLEVBQWN0RixTQUFTb0QsaUJBQWlCLDJDQUN4Q21DLEVBQWlCdkYsU0FBU29ELGlCQUFpQiw4Q0FFdEMzQixFQUFJLEVBQUdBLEVBQUk0RCxFQUFTN0QsT0FBUUMsSUFDcEM0RCxFQUFTNUQsR0FBR1EsVUFBVTJCLE9BQU8sVUFHOUIsSUFBSyxJQUFJbkMsRUFBSSxFQUFHQSxFQUFJNkQsRUFBWTlELE9BQVFDLElBQ3ZDNkQsRUFBWTdELEdBQUdRLFdBQWEsVUFHN0IsSUFBSyxJQUFJUixFQUFJLEVBQUdBLEVBQUk4RCxFQUFlL0QsT0FBUUMsSUFDMUM4RCxFQUFlOUQsR0FBR1EsV0FBYSxVQU1oQyxJQUFJdUQsRUFBY3hGLFNBQVNPLGVBQWUsZUFBaUJVLEdBQ3ZEd0UsRUFBc0J6RixTQUFTTyxlQUFlLFFBQVVVLEdBRTVEdUUsRUFBWXZELFVBQVUyQixPQUFPLFVBQzdCNkIsRUFBb0J4RCxXQUFhLFVBT2pDLElBQUl5RCxFQUEwQkYsRUFBWXhDLFFBQVF1QyxlQUFlSSxNQUFNLE1BTXZFRCxFQUEwQkEsRUFBd0JFLFFBQU8sU0FBQXpCLEdBQUMsT0FBSUEsQ0FBQyxLQUVuQzNDLE9BQVMsR0FJckNrRSxFQUF3QnBDLFNBQVEsU0FBVXVDLEdBQ3pDLElBQUlDLEVBQWdCOUYsU0FBU08sZUFBZSxrQkFBb0JzRixHQUM1REUsRUFBZS9GLFNBQVNPLGVBQWUsUUFBVXNGLEdBRXJEQyxFQUFjN0QsVUFBVTJCLE9BQU8sVUFDL0JtQyxFQUFhOUQsV0FBYSxTQUMzQixHQXZEQSxDQXdERCxFQVdBaUIsS0FBTSxTQUFVcUIsR0FBMEMsSUFBcENsQyxFQUFNMkQsVUFBQXhFLE9BQUEsUUFBQXlFLElBQUFELFVBQUEsR0FBQUEsVUFBQSxHQUFHLEtBQU1sRSxJQUFZa0UsVUFBQXhFLE9BQUEsUUFBQXlFLElBQUFELFVBQUEsS0FBQUEsVUFBQSxHQUNoRCxPQUFPRSxNQUNOQyxRQUNBLENBQ0NDLE9BQVEsT0FDUkMsS0FBTTlCLElBRU5DLE1BQUssU0FBQUMsR0FhTixPQVpJcEMsSUFDQ0EsRUFBT3NCLFNBQVNuQyxPQUFTLElBQzVCYSxFQUFPc0IsU0FBUyxHQUFHMUIsV0FBYSxXQUdmLGdDQUFkSSxFQUFPaUUsSUFBNEQsTUFBcEI3QixFQUFTOEIsT0FDM0RsRSxFQUFPbUUsVUFBWUMseUJBQXlCQyxVQUU1Q3JFLEVBQU9zQyxnQkFBZ0IsYUFJRCxNQUFwQkYsRUFBUzhCLFFBQ0w5QixFQUFTa0MsTUFJbEIsSUFBR25DLE1BQUssU0FBQUMsSUFDYyxJQUFqQjNDLEdBQ0h6QixFQUFVeUIsZUFHWCxJQUFJOEUsRUFBUSxJQUFJQyxZQUFZLG9CQUFxQixDQUFDQyxPQUFRckMsSUFJMUQsT0FGQXpFLFNBQVMrRyxjQUFjSCxRQUVEWCxJQUFsQnhCLEVBQVNGLEtBQ0xFLEVBQVNGLEtBRVRFLENBRVQsR0FDRCxFQUtBM0MsYUFBYyxXQUNFekIsRUFBVTJHLGdCQUVoQnhDLE1BQUssU0FBVXlDLElBQ0EsSUFBbkJBLEVBQVNDLE1BQ1o3RyxFQUFVOEcsWUFBWUYsRUFBU0MsTUFBTyxVQUNSLElBQXBCRCxFQUFTRyxPQUNuQi9HLEVBQVU4RyxZQUFZRixFQUFTRyxPQUFRLFdBQ1IsSUFBckJILEVBQVN2QyxTQUNuQnJFLEVBQVU4RyxZQUFZRixFQUFTdkMsUUFBUyxXQUdOLElBQS9CdUMsRUFBU0ksV0FBVzdGLFFBQTBFLE9BQTFEeEIsU0FBU08sZUFBZSxxQ0FJakMwRixJQUEzQmdCLEVBQVNJLFdBQVdmLElBQW9CVyxFQUFTSSxXQUFXQyxRQUMvRGpILEVBQVVrSCxzQkFBc0JOLEVBQVNJLFdBQVdDLFFBQVNMLEVBQVNJLFdBQVdmLFNBQzVDTCxJQUEzQmdCLEVBQVNJLFdBQVdmLElBQW9ELEtBQWhDVyxFQUFTSSxXQUFXQyxTQUN0RWpILEVBQVVtSCx3QkFBd0JQLEVBQVNJLFdBQVdmLElBRXhELEdBQ0QsRUFLQVUsY0FBZSxXQUNkLElBQUl6QyxFQUFPLElBQUk1QixTQUtmLE9BSkE0QixFQUFLM0IsT0FBTyxTQUFVLGdDQUVUdkMsRUFBVTZDLEtBQUtxQixFQUFNLE1BQU0sR0FFMUJDLE1BQUssU0FBVUMsR0FDNUIsT0FBT0EsQ0FDUixHQUNELEVBUUEwQyxZQUFhLFNBQVVHLEdBQTJCLElBQWxCL0UsRUFBSXlELFVBQUF4RSxPQUFBLFFBQUF5RSxJQUFBRCxVQUFBLEdBQUFBLFVBQUEsR0FBRyxVQUN6QixVQUFUekQsR0FDSHZDLFNBQVNPLGVBQWUsY0FBYzBCLFVBQVUyQixPQUFPLFVBQ3ZENUQsU0FBU08sZUFBZSxnQkFBZ0IwQixVQUFVd0YsSUFBSSxVQUN0RHpILFNBQVNPLGVBQWUsZUFBZTBCLFVBQVV3RixJQUFJLFdBQ2xDLFdBQVRsRixHQUNWdkMsU0FBU08sZUFBZSxlQUFlMEIsVUFBVTJCLE9BQU8sVUFDeEQ1RCxTQUFTTyxlQUFlLGNBQWMwQixVQUFVd0YsSUFBSSxVQUNwRHpILFNBQVNPLGVBQWUsZ0JBQWdCMEIsVUFBVXdGLElBQUksWUFFdER6SCxTQUFTTyxlQUFlLGdCQUFnQjBCLFVBQVUyQixPQUFPLFVBQ3pENUQsU0FBU08sZUFBZSxjQUFjMEIsVUFBVXdGLElBQUksVUFDcER6SCxTQUFTTyxlQUFlLGVBQWUwQixVQUFVd0YsSUFBSSxXQUd0RCxJQUFJTCxFQUFTcEgsU0FBU08sZUFBZSw4QkFFckNQLFNBQVNPLGVBQWUsbUNBQW1Dd0MsVUFBWXVFLEVBRXZFRixFQUFPbkYsVUFBVTJCLE9BQU8sVUFFeEI4RCxZQUFXLFdBQ1ZOLEVBQU9uRixVQUFVUSxRQUFRLFlBQWEsY0FDdkMsR0FBRyxLQUVVLFVBQVRGLEdBQ0htRixZQUFXLFdBQ1ZOLEVBQU9uRixVQUFVUSxRQUFRLGNBQWUsYUFDeENpRixZQUFXLFdBQ1ZOLEVBQU9uRixXQUFhLFNBQ3JCLEdBQUcsSUFDSixHQUFHLElBRUwsRUFPQXNGLHNCQUF1QixTQUFVSSxFQUFNM0YsR0FDckJoQyxTQUFTd0MsY0FBYyxVQUFEMEMsT0FBV2xELEVBQU0sT0FDN0JNLFFBQVEsOEJBRXpCUyxXQUFhNEUsQ0FDeEIsRUFPQUgsd0JBQXlCLFNBQVV4RixHQUNsQyxJQUVJNEYsRUFEQUMsRUFEYTdILFNBQVN3QyxjQUFjLFVBQUQwQyxPQUFXbEQsRUFBTSxPQUM3Qk0sUUFBUSw4QkFHbkMsR0FBSXVGLEVBQVVsRSxTQUFTbkMsT0FBUyxFQUMvQixJQUFLLElBQUlDLEVBQUksRUFBR0EsRUFBSW9HLEVBQVVsRSxTQUFTbkMsT0FBUUMsSUFDOUMsR0FBSW9HLEVBQVVsRSxTQUFTbEMsR0FBR1EsVUFBVUMsU0FBUyw0QkFBNkIsQ0FDekUwRixFQUFvQkMsRUFBVWxFLFNBQVNsQyxHQUV2QyxLQUNELE1BSXdCd0UsSUFBdEIyQixHQUNIQyxFQUFVQyxZQUFZRixFQUV4QixHQUdEdkgsRUFBVVcsTUE1ZVYsQ0E2ZUQsRyIsInNvdXJjZXMiOlsid2VicGFjazovL3BsYXVzaWJsZS1hbmFseXRpY3MvLi9hc3NldHMvc3JjL2pzL2FkbWluL21haW4uanMiXSwic291cmNlc0NvbnRlbnQiOlsiLyoqXG4gKiBQbGF1c2libGUgQW5hbHl0aWNzXG4gKlxuICogQWRtaW4gSlNcbiAqL1xuZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcignRE9NQ29udGVudExvYWRlZCcsICgpID0+IHtcblx0aWYgKCFkb2N1bWVudC5sb2NhdGlvbi5ocmVmLmluY2x1ZGVzKCdwbGF1c2libGVfYW5hbHl0aWNzJykpIHtcblx0XHRyZXR1cm47XG5cdH1cblxuXHRsZXQgcGxhdXNpYmxlID0ge1xuXHRcdC8qKlxuXHRcdCAqIFByb3BlcnRpZXNcblx0XHQgKi9cblx0XHRub25jZUVsZW06IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdfd3Bub25jZScpLFxuXHRcdG5vbmNlOiAnJyxcblx0XHRzaG93V2l6YXJkRWxlbTogZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3Nob3dfd2l6YXJkJyksXG5cdFx0ZG9tYWluTmFtZUVsZW06IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdkb21haW5fbmFtZScpLFxuXHRcdGFwaVRva2VuRWxlbTogZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2FwaV90b2tlbicpLFxuXHRcdGNyZWF0ZUFQSVRva2VuRWxlbXM6IGRvY3VtZW50LmdldEVsZW1lbnRzQnlDbGFzc05hbWUoJ3BsYXVzaWJsZS1jcmVhdGUtYXBpLXRva2VuJyksXG5cdFx0YnV0dG9uRWxlbXM6IGRvY3VtZW50LmdldEVsZW1lbnRzQnlDbGFzc05hbWUoJ3BsYXVzaWJsZS1hbmFseXRpY3MtYnV0dG9uJyksXG5cdFx0c3RlcEVsZW1zOiBkb2N1bWVudC5nZXRFbGVtZW50c0J5Q2xhc3NOYW1lKCdwbGF1c2libGUtYW5hbHl0aWNzLXdpemFyZC1uZXh0LXN0ZXAnKSxcblxuXHRcdC8qKlxuXHRcdCAqIEJpbmQgZXZlbnRzLlxuXHRcdCAqL1xuXHRcdGluaXQ6IGZ1bmN0aW9uICgpIHtcblx0XHRcdGlmIChkb2N1bWVudC5sb2NhdGlvbi5oYXNoID09PSAnJyAmJiBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgncGxhdXNpYmxlLWFuYWx5dGljcy13aXphcmQnKSAhPT0gbnVsbCkge1xuXHRcdFx0XHRkb2N1bWVudC5sb2NhdGlvbi5oYXNoID0gJyN3ZWxjb21lX3NsaWRlJztcblx0XHRcdH1cblxuXHRcdFx0aWYgKHRoaXMubm9uY2VFbGVtICE9PSBudWxsKSB7XG5cdFx0XHRcdHRoaXMubm9uY2UgPSB0aGlzLm5vbmNlRWxlbS52YWx1ZTtcblx0XHRcdH1cblxuXHRcdFx0dGhpcy50b2dnbGVXaXphcmRTdGVwKCk7XG5cblx0XHRcdHdpbmRvdy5hZGRFdmVudExpc3RlbmVyKCdoYXNoY2hhbmdlJywgdGhpcy50b2dnbGVXaXphcmRTdGVwKTtcblxuXHRcdFx0aWYgKHRoaXMuc2hvd1dpemFyZEVsZW0gIT09IG51bGwpIHtcblx0XHRcdFx0dGhpcy5zaG93V2l6YXJkRWxlbS5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIHRoaXMuc2hvd1dpemFyZCk7XG5cdFx0XHR9XG5cblx0XHRcdGlmICh0aGlzLmRvbWFpbk5hbWVFbGVtICE9PSBudWxsKSB7XG5cdFx0XHRcdHRoaXMuZG9tYWluTmFtZUVsZW0uYWRkRXZlbnRMaXN0ZW5lcigna2V5dXAnLCB0aGlzLmRpc2FibGVDb25uZWN0QnV0dG9uKTtcblx0XHRcdH1cblxuXHRcdFx0aWYgKHRoaXMuYXBpVG9rZW5FbGVtICE9PSBudWxsKSB7XG5cdFx0XHRcdHRoaXMuYXBpVG9rZW5FbGVtLmFkZEV2ZW50TGlzdGVuZXIoJ2tleXVwJywgdGhpcy5kaXNhYmxlQ29ubmVjdEJ1dHRvbik7XG5cdFx0XHR9XG5cblx0XHRcdGlmICh0aGlzLmNyZWF0ZUFQSVRva2VuRWxlbXMubGVuZ3RoID4gMCkge1xuXHRcdFx0XHRmb3IgKGxldCBpID0gMDsgaSA8IHRoaXMuY3JlYXRlQVBJVG9rZW5FbGVtcy5sZW5ndGg7IGkrKykge1xuXHRcdFx0XHRcdHRoaXMuY3JlYXRlQVBJVG9rZW5FbGVtc1tpXS5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIHRoaXMuY3JlYXRlQVBJVG9rZW4pO1xuXHRcdFx0XHR9XG5cdFx0XHR9XG5cblx0XHRcdGlmICh0aGlzLmJ1dHRvbkVsZW1zLmxlbmd0aCA+IDApIHtcblx0XHRcdFx0Zm9yIChsZXQgaSA9IDA7IGkgPCB0aGlzLmJ1dHRvbkVsZW1zLmxlbmd0aDsgaSsrKSB7XG5cdFx0XHRcdFx0dGhpcy5idXR0b25FbGVtc1tpXS5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIHRoaXMuc2F2ZU9wdGlvbik7XG5cdFx0XHRcdH1cblx0XHRcdH1cblxuXHRcdFx0LyoqXG5cdFx0XHQgKiBEdWUgdG8gdGhlIHN0cnVjdHVyZSBvZiB0aGUgdG9nZ2xlcywgYW55IGV2ZW50cyBib3VuZCB0byB0aGVtIHdvdWxkIGJlIHRyaWdnZXJlZCB0d2ljZSwgdGhhdCdzIHdoeSB3ZSBiaW5kIGl0IHRvIHRoZSBkb2N1bWVudHMnIGNsaWNrJ1xuXHRcdFx0ICogZXZlbnQuXG5cdFx0XHQgKi9cblx0XHRcdGRvY3VtZW50LmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgdGhpcy50b2dnbGVPcHRpb24pO1xuXG5cdFx0XHRpZiAodGhpcy5zdGVwRWxlbXMubGVuZ3RoID4gMCkge1xuXHRcdFx0XHRmb3IgKGxldCBpID0gMDsgaSA8IHRoaXMuc3RlcEVsZW1zLmxlbmd0aDsgaSsrKSB7XG5cdFx0XHRcdFx0dGhpcy5zdGVwRWxlbXNbaV0uYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCB0aGlzLnNhdmVPcHRpb25Pbk5leHQpO1xuXHRcdFx0XHR9XG5cdFx0XHR9XG5cblx0XHRcdC8qKlxuXHRcdFx0ICogUnVuIG9uY2Ugb24gcGFnZWxvYWQuXG5cdFx0XHQgKi9cblx0XHRcdHRoaXMuc2hvd01lc3NhZ2VzKCk7XG5cdFx0fSxcblxuXHRcdC8qKlxuXHRcdCAqIFRvZ2dsZSBPcHRpb24gYW5kIHN0b3JlIGluIERCLlxuXHRcdCAqXG5cdFx0ICogQHBhcmFtIGVcblx0XHQgKi9cblx0XHR0b2dnbGVPcHRpb246IGZ1bmN0aW9uIChlKSB7XG5cdFx0XHQvKipcblx0XHRcdCAqIE1ha2Ugc3VyZSBldmVudCB0YXJnZXQgaXMgYSB0b2dnbGUuXG5cdFx0XHQgKi9cblx0XHRcdGlmIChlLnRhcmdldC5jbGFzc0xpc3QgPT09IG51bGwgfHwgIWUudGFyZ2V0LmNsYXNzTGlzdC5jb250YWlucygncGxhdXNpYmxlLWFuYWx5dGljcy10b2dnbGUnKSkge1xuXHRcdFx0XHRyZXR1cm47XG5cdFx0XHR9XG5cblx0XHRcdGNvbnN0IGJ1dHRvbiA9IGUudGFyZ2V0LmNsb3Nlc3QoJ2J1dHRvbicpO1xuXHRcdFx0bGV0IHRvZ2dsZTtcblxuXHRcdFx0Ly8gVGhlIGJ1dHRvbiBlbGVtZW50IGlzIGNsaWNrZWQuXG5cdFx0XHRpZiAoZS50YXJnZXQudHlwZSA9PT0gJ3N1Ym1pdCcpIHtcblx0XHRcdFx0dG9nZ2xlID0gYnV0dG9uLnF1ZXJ5U2VsZWN0b3IoJ3NwYW4nKTtcblx0XHRcdH0gZWxzZSB7XG5cdFx0XHRcdC8vIFRoZSBzcGFuIGVsZW1lbnQgaXMgY2xpY2tlZC5cblx0XHRcdFx0dG9nZ2xlID0gZS50YXJnZXQuY2xvc2VzdCgnc3BhbicpO1xuXHRcdFx0fVxuXG5cdFx0XHRsZXQgdG9nZ2xlU3RhdHVzO1xuXG5cdFx0XHRpZiAoYnV0dG9uLmNsYXNzTGlzdC5jb250YWlucygnYmctaW5kaWdvLTYwMCcpKSB7XG5cdFx0XHRcdC8vIFRvZ2dsZTogb2ZmXG5cdFx0XHRcdGJ1dHRvbi5jbGFzc0xpc3QucmVwbGFjZSgnYmctaW5kaWdvLTYwMCcsICdiZy1ncmF5LTIwMCcpO1xuXHRcdFx0XHR0b2dnbGUuY2xhc3NMaXN0LnJlcGxhY2UoJ3RyYW5zbGF0ZS14LTUnLCAndHJhbnNsYXRlLXgtMCcpO1xuXHRcdFx0XHR0b2dnbGVTdGF0dXMgPSAnJztcblx0XHRcdH0gZWxzZSB7XG5cdFx0XHRcdC8vIFRvZ2dsZTogb25cblx0XHRcdFx0YnV0dG9uLmNsYXNzTGlzdC5yZXBsYWNlKCdiZy1ncmF5LTIwMCcsICdiZy1pbmRpZ28tNjAwJyk7XG5cdFx0XHRcdHRvZ2dsZS5jbGFzc0xpc3QucmVwbGFjZSgndHJhbnNsYXRlLXgtMCcsICd0cmFuc2xhdGUteC01Jyk7XG5cdFx0XHRcdHRvZ2dsZVN0YXR1cyA9ICdvbic7XG5cdFx0XHR9XG5cblx0XHRcdGNvbnN0IGZvcm0gPSBuZXcgRm9ybURhdGEoKTtcblx0XHRcdGZvcm0uYXBwZW5kKCdhY3Rpb24nLCAncGxhdXNpYmxlX2FuYWx5dGljc190b2dnbGVfb3B0aW9uJyk7XG5cdFx0XHRmb3JtLmFwcGVuZCgnb3B0aW9uX25hbWUnLCBidXR0b24ubmFtZSk7XG5cdFx0XHRmb3JtLmFwcGVuZCgnb3B0aW9uX3ZhbHVlJywgYnV0dG9uLnZhbHVlKTtcblx0XHRcdGZvcm0uYXBwZW5kKCdvcHRpb25fbGFiZWwnLCBidXR0b24ubmV4dEVsZW1lbnRTaWJsaW5nLmlubmVySFRNTCk7XG5cdFx0XHRmb3JtLmFwcGVuZCgndG9nZ2xlX3N0YXR1cycsIHRvZ2dsZVN0YXR1cyk7XG5cdFx0XHRmb3JtLmFwcGVuZCgnaXNfbGlzdCcsIGJ1dHRvbi5kYXRhc2V0Lmxpc3QpO1xuXHRcdFx0Zm9ybS5hcHBlbmQoJ19ub25jZScsIHBsYXVzaWJsZS5ub25jZSk7XG5cblx0XHRcdHBsYXVzaWJsZS5hamF4KGZvcm0pO1xuXHRcdH0sXG5cblx0XHQvKipcblx0XHQgKiBTYXZlIHZhbHVlIG9mIGlucHV0IG9yIHRleHQgYXJlYSB0byBEQi5cblx0XHQgKlxuXHRcdCAqIEBwYXJhbSBlXG5cdFx0ICovXG5cdFx0c2F2ZU9wdGlvbjogZnVuY3Rpb24gKGUpIHtcblx0XHRcdGNvbnN0IGJ1dHRvbiA9IGUudGFyZ2V0O1xuXHRcdFx0Y29uc3Qgc2VjdGlvbiA9IGJ1dHRvbi5jbG9zZXN0KCcucGxhdXNpYmxlLWFuYWx5dGljcy1zZWN0aW9uJyk7XG5cdFx0XHRjb25zdCBpbnB1dHMgPSBzZWN0aW9uLnF1ZXJ5U2VsZWN0b3JBbGwoJ2lucHV0LCB0ZXh0YXJlYScpO1xuXHRcdFx0Y29uc3QgZm9ybSA9IG5ldyBGb3JtRGF0YSgpO1xuXHRcdFx0Y29uc3Qgb3B0aW9ucyA9IFtdO1xuXG5cdFx0XHRpbnB1dHMuZm9yRWFjaChmdW5jdGlvbiAoaW5wdXQpIHtcblx0XHRcdFx0b3B0aW9ucy5wdXNoKHtuYW1lOiBpbnB1dC5uYW1lLCB2YWx1ZTogaW5wdXQudmFsdWV9KTtcblx0XHRcdH0pO1xuXG5cdFx0XHRmb3JtLmFwcGVuZCgnYWN0aW9uJywgJ3BsYXVzaWJsZV9hbmFseXRpY3Nfc2F2ZV9vcHRpb25zJyk7XG5cdFx0XHRmb3JtLmFwcGVuZCgnb3B0aW9ucycsIEpTT04uc3RyaW5naWZ5KG9wdGlvbnMpKTtcblx0XHRcdGZvcm0uYXBwZW5kKCdfbm9uY2UnLCBwbGF1c2libGUubm9uY2UpO1xuXG5cdFx0XHRpZiAoYnV0dG9uLmNoaWxkcmVuLmxlbmd0aCA+IDApIHtcblx0XHRcdFx0YnV0dG9uLmNoaWxkcmVuWzBdLmNsYXNzTGlzdC5yZW1vdmUoJ2hpZGRlbicpO1xuXHRcdFx0fVxuXG5cdFx0XHRidXR0b24uc2V0QXR0cmlidXRlKCdkaXNhYmxlZCcsICdkaXNhYmxlZCcpO1xuXG5cdFx0XHRwbGF1c2libGUuYWpheChmb3JtLCBidXR0b24pO1xuXHRcdH0sXG5cblx0XHQvKipcblx0XHQgKiBTYXZlIE9wdGlvbnMgb24gTmV4dCBjbGljayBmb3IgQVBJIFRva2VuIGFuZCBEb21haW4gTmFtZSBzbGlkZXMuXG5cdFx0ICpcblx0XHQgKiBAcGFyYW0gZVxuXHRcdCAqL1xuXHRcdHNhdmVPcHRpb25Pbk5leHQ6IGZ1bmN0aW9uIChlKSB7XG5cdFx0XHRsZXQgaGFzaCA9IGRvY3VtZW50LmxvY2F0aW9uLmhhc2gucmVwbGFjZSgnIycsICcnKTtcblxuXHRcdFx0aWYgKGhhc2ggIT09ICdhcGlfdG9rZW5fc2xpZGUnICYmIGhhc2ggIT09ICdkb21haW5fbmFtZV9zbGlkZScpIHtcblx0XHRcdFx0cmV0dXJuO1xuXHRcdFx0fVxuXG5cdFx0XHRsZXQgZm9ybSA9IGUudGFyZ2V0LmNsb3Nlc3QoJy5wbGF1c2libGUtYW5hbHl0aWNzLXdpemFyZC1zdGVwLXNlY3Rpb24nKTtcblx0XHRcdGxldCBpbnB1dHMgPSBmb3JtLmdldEVsZW1lbnRzQnlUYWdOYW1lKCdJTlBVVCcpO1xuXHRcdFx0bGV0IG9wdGlvbnMgPSBbXTtcblxuXHRcdFx0Zm9yIChsZXQgaW5wdXQgb2YgaW5wdXRzKSB7XG5cdFx0XHRcdG9wdGlvbnMucHVzaCh7bmFtZTogaW5wdXQubmFtZSwgdmFsdWU6IGlucHV0LnZhbHVlfSk7XG5cdFx0XHR9XG5cblx0XHRcdGxldCBkYXRhID0gbmV3IEZvcm1EYXRhKCk7XG5cblx0XHRcdGRhdGEuYXBwZW5kKCdhY3Rpb24nLCAncGxhdXNpYmxlX2FuYWx5dGljc19zYXZlX29wdGlvbnMnKTtcblx0XHRcdGRhdGEuYXBwZW5kKCdvcHRpb25zJywgSlNPTi5zdHJpbmdpZnkob3B0aW9ucykpO1xuXHRcdFx0ZGF0YS5hcHBlbmQoJ19ub25jZScsIHBsYXVzaWJsZS5ub25jZSk7XG5cblx0XHRcdHBsYXVzaWJsZS5hamF4KGRhdGEpLnRoZW4ocmVzcG9uc2UgPT4ge1xuXHRcdFx0XHQvKipcblx0XHRcdFx0ICogRGlzYWJsZSBWaWV3IFN0YXRzIGJ1dHRvbiwgaWYgQVBJIHRva2VuIGlzIGVudGVyZWQgYW5kIHZhbGlkLlxuXHRcdFx0XHQgKi9cblx0XHRcdFx0aWYgKGhhc2ggPT09ICdhcGlfdG9rZW5fc2xpZGUnICYmIHJlc3BvbnNlLnN1Y2Nlc3MgPT09IHRydWUpIHtcblx0XHRcdFx0XHRsZXQgc3RhdHNfYnV0dG9uID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2VuYWJsZV9hbmFseXRpY3NfZGFzaGJvYXJkX3ZpZXdfc3RhdHNfaW5fd29yZHByZXNzJyk7XG5cblx0XHRcdFx0XHRzdGF0c19idXR0b24ucmVtb3ZlQXR0cmlidXRlKCdkaXNhYmxlZCcpO1xuXHRcdFx0XHR9XG5cdFx0XHR9KTtcblx0XHR9LFxuXG5cdFx0LyoqXG5cdFx0ICogRGlzYWJsZSBDb25uZWN0IGJ1dHRvbiBpZiBEb21haW4gTmFtZSBvciBBUEkgVG9rZW4gZmllbGQgaXMgZW1wdHkuXG5cdFx0ICpcblx0XHQgKiBAcGFyYW0gZVxuXHRcdCAqL1xuXHRcdGRpc2FibGVDb25uZWN0QnV0dG9uOiBmdW5jdGlvbiAoZSkge1xuXHRcdFx0bGV0IHRhcmdldCA9IGUudGFyZ2V0O1xuXHRcdFx0bGV0IGJ1dHRvbiA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdjb25uZWN0X3BsYXVzaWJsZV9hbmFseXRpY3MnKTtcblx0XHRcdGxldCBidXR0b25Jc0hyZWYgPSBmYWxzZTtcblxuXHRcdFx0aWYgKGJ1dHRvbiA9PT0gbnVsbCkge1xuXHRcdFx0XHRsZXQgc2xpZGVfaWQgPSBkb2N1bWVudC5sb2NhdGlvbi5oYXNoO1xuXHRcdFx0XHRidXR0b24gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKHNsaWRlX2lkICsgJyAucGxhdXNpYmxlLWFuYWx5dGljcy13aXphcmQtbmV4dC1zdGVwJyk7XG5cdFx0XHRcdGJ1dHRvbklzSHJlZiA9IHRydWU7XG5cdFx0XHR9XG5cblx0XHRcdGlmIChidXR0b24gPT09IG51bGwpIHtcblx0XHRcdFx0cmV0dXJuO1xuXHRcdFx0fVxuXG5cdFx0XHRpZiAodGFyZ2V0LnZhbHVlICE9PSAnJykge1xuXHRcdFx0XHRpZiAoIWJ1dHRvbklzSHJlZikge1xuXHRcdFx0XHRcdGJ1dHRvbi5kaXNhYmxlZCA9IGZhbHNlO1xuXHRcdFx0XHR9IGVsc2Uge1xuXHRcdFx0XHRcdGJ1dHRvbi5jbGFzc0xpc3QucmVtb3ZlKCdwb2ludGVyLWV2ZW50cy1ub25lJyk7XG5cdFx0XHRcdFx0YnV0dG9uLmNsYXNzTGlzdC5yZXBsYWNlKCdiZy1ncmF5LTIwMCcsICdiZy1pbmRpZ28tNjAwJylcblx0XHRcdFx0fVxuXG5cdFx0XHRcdHJldHVybjtcblx0XHRcdH1cblxuXHRcdFx0aWYgKCFidXR0b25Jc0hyZWYpIHtcblx0XHRcdFx0YnV0dG9uLmRpc2FibGVkID0gdHJ1ZTtcblx0XHRcdFx0YnV0dG9uLmlubmVySFRNTCA9IGJ1dHRvbi5pbm5lckhUTUwucmVwbGFjZSgnQ29ubmVjdGVkJywgJ0Nvbm5lY3QnKTtcblx0XHRcdH0gZWxzZSB7XG5cdFx0XHRcdGJ1dHRvbi5jbGFzc0xpc3QgKz0gJyBwb2ludGVyLWV2ZW50cy1ub25lJztcblx0XHRcdFx0YnV0dG9uLmNsYXNzTGlzdC5yZXBsYWNlKCdiZy1pbmRpZ28tNjAwJywgJ2JnLWdyYXktMjAwJylcblx0XHRcdH1cblx0XHR9LFxuXG5cdFx0LyoqXG5cdFx0ICogT3BlbiBjcmVhdGUgQVBJIHRva2VuIGRpYWxvZy5cblx0XHQgKlxuXHRcdCAqIEBwYXJhbSBlXG5cdFx0ICovXG5cdFx0Y3JlYXRlQVBJVG9rZW46IGZ1bmN0aW9uIChlKSB7XG5cdFx0XHRlLnByZXZlbnREZWZhdWx0KCk7XG5cblx0XHRcdGxldCBkb21haW4gPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnZG9tYWluX25hbWUnKS52YWx1ZTtcblx0XHRcdGRvbWFpbiA9IGRvbWFpbi5yZXBsYWNlKCcvJywgJyUyRicpO1xuXG5cdFx0XHR3aW5kb3cub3BlbihgJHtwbGF1c2libGVfYW5hbHl0aWNzX2hvc3RlZF9kb21haW59LyR7ZG9tYWlufS9zZXR0aW5ncy9pbnRlZ3JhdGlvbnM/bmV3X3Rva2VuPVdvcmRQcmVzc2AsICdfYmxhbmsnLCAnbG9jYXRpb249eWVzLGhlaWdodD03Njgsd2lkdGg9MTAyNCxzY3JvbGxiYXJzPXllcyxzdGF0dXM9bm8nKTtcblx0XHR9LFxuXG5cdFx0LyoqXG5cdFx0ICogU2hvdyB3aXphcmQuXG5cdFx0ICpcblx0XHQgKiBAcGFyYW0gZVxuXHRcdCAqL1xuXHRcdHNob3dXaXphcmQ6IGZ1bmN0aW9uIChlKSB7XG5cdFx0XHRsZXQgZGF0YSA9IG5ldyBGb3JtRGF0YSgpO1xuXHRcdFx0ZGF0YS5hcHBlbmQoJ2FjdGlvbicsICdwbGF1c2libGVfYW5hbHl0aWNzX3Nob3dfd2l6YXJkJyk7XG5cdFx0XHRkYXRhLmFwcGVuZCgnX25vbmNlJywgZS50YXJnZXQuZGF0YXNldC5ub25jZSk7XG5cblx0XHRcdHBsYXVzaWJsZS5hamF4KGRhdGEpO1xuXHRcdH0sXG5cblx0XHQvKipcblx0XHQgKiBUb2dnbGVzIHRoZSBhY3RpdmUvaW5hY3RpdmUvY3VycmVudCBzdGF0ZSBvZiB0aGUgc3RlcHMuXG5cdFx0ICovXG5cdFx0dG9nZ2xlV2l6YXJkU3RlcDogZnVuY3Rpb24gKCkge1xuXHRcdFx0aWYgKGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdwbGF1c2libGUtYW5hbHl0aWNzLXdpemFyZCcpID09PSBudWxsKSB7XG5cdFx0XHRcdHJldHVybjtcblx0XHRcdH1cblxuXHRcdFx0Y29uc3QgaGFzaCA9IGRvY3VtZW50LmxvY2F0aW9uLmhhc2guc3Vic3RyaW5nKDEpLnJlcGxhY2UoJ19zbGlkZScsICcnKTtcblxuXHRcdFx0LyoqXG5cdFx0XHQgKiBSZXNldCBhbGwgc3RlcHMgdG8gaW5hY3RpdmUuXG5cdFx0XHQgKi9cblx0XHRcdGxldCBhbGxTdGVwcyA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoJy5wbGF1c2libGUtYW5hbHl0aWNzLXdpemFyZC1zdGVwJyk7XG5cdFx0XHRsZXQgYWN0aXZlU3RlcHMgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKCcucGxhdXNpYmxlLWFuYWx5dGljcy13aXphcmQtYWN0aXZlLXN0ZXAnKTtcblx0XHRcdGxldCBjb21wbGV0ZWRTdGVwcyA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoJy5wbGF1c2libGUtYW5hbHl0aWNzLXdpemFyZC1jb21wbGV0ZWQtc3RlcCcpO1xuXG5cdFx0XHRmb3IgKGxldCBpID0gMDsgaSA8IGFsbFN0ZXBzLmxlbmd0aDsgaSsrKSB7XG5cdFx0XHRcdGFsbFN0ZXBzW2ldLmNsYXNzTGlzdC5yZW1vdmUoJ2hpZGRlbicpO1xuXHRcdFx0fVxuXG5cdFx0XHRmb3IgKGxldCBpID0gMDsgaSA8IGFjdGl2ZVN0ZXBzLmxlbmd0aDsgaSsrKSB7XG5cdFx0XHRcdGFjdGl2ZVN0ZXBzW2ldLmNsYXNzTGlzdCArPSAnIGhpZGRlbic7XG5cdFx0XHR9XG5cblx0XHRcdGZvciAobGV0IGkgPSAwOyBpIDwgY29tcGxldGVkU3RlcHMubGVuZ3RoOyBpKyspIHtcblx0XHRcdFx0Y29tcGxldGVkU3RlcHNbaV0uY2xhc3NMaXN0ICs9ICcgaGlkZGVuJztcblx0XHRcdH1cblxuXHRcdFx0LyoqXG5cdFx0XHQgKiBNYXJrIGN1cnJlbnQgc3RlcCBhcyBhY3RpdmUuXG5cdFx0XHQgKi9cblx0XHRcdGxldCBjdXJyZW50U3RlcCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdhY3RpdmUtc3RlcC0nICsgaGFzaCk7XG5cdFx0XHRsZXQgaW5hY3RpdmVDdXJyZW50U3RlcCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdzdGVwLScgKyBoYXNoKTtcblxuXHRcdFx0Y3VycmVudFN0ZXAuY2xhc3NMaXN0LnJlbW92ZSgnaGlkZGVuJyk7XG5cdFx0XHRpbmFjdGl2ZUN1cnJlbnRTdGVwLmNsYXNzTGlzdCArPSAnIGhpZGRlbic7XG5cblx0XHRcdC8qKlxuXHRcdFx0ICogTWFyayBzdGVwcyBhcyBjb21wbGV0ZWQuXG5cdFx0XHQgKlxuXHRcdFx0ICogQHR5cGUge3N0cmluZ1tdfVxuXHRcdFx0ICovXG5cdFx0XHRsZXQgY3VycmVudGx5Q29tcGxldGVkU3RlcHMgPSBjdXJyZW50U3RlcC5kYXRhc2V0LmNvbXBsZXRlZFN0ZXBzLnNwbGl0KCcsJyk7XG5cblx0XHRcdC8qKlxuXHRcdFx0ICogRmlsdGVyIGVtcHR5IGFycmF5IGVsZW1lbnRzLlxuXHRcdFx0ICogQHR5cGUge3N0cmluZ1tdfVxuXHRcdFx0ICovXG5cdFx0XHRjdXJyZW50bHlDb21wbGV0ZWRTdGVwcyA9IGN1cnJlbnRseUNvbXBsZXRlZFN0ZXBzLmZpbHRlcihuID0+IG4pO1xuXG5cdFx0XHRpZiAoY3VycmVudGx5Q29tcGxldGVkU3RlcHMubGVuZ3RoIDwgMSkge1xuXHRcdFx0XHRyZXR1cm47XG5cdFx0XHR9XG5cblx0XHRcdGN1cnJlbnRseUNvbXBsZXRlZFN0ZXBzLmZvckVhY2goZnVuY3Rpb24gKHN0ZXApIHtcblx0XHRcdFx0bGV0IGNvbXBsZXRlZFN0ZXAgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnY29tcGxldGVkLXN0ZXAtJyArIHN0ZXApO1xuXHRcdFx0XHRsZXQgaW5hY3RpdmVTdGVwID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3N0ZXAtJyArIHN0ZXApO1xuXG5cdFx0XHRcdGNvbXBsZXRlZFN0ZXAuY2xhc3NMaXN0LnJlbW92ZSgnaGlkZGVuJyk7XG5cdFx0XHRcdGluYWN0aXZlU3RlcC5jbGFzc0xpc3QgKz0gJyBoaWRkZW4nO1xuXHRcdFx0fSk7XG5cdFx0fSxcblxuXHRcdC8qKlxuXHRcdCAqIERvIEFKQVggcmVxdWVzdC5cblx0XHQgKlxuXHRcdCAqIEBwYXJhbSBkYXRhXG5cdFx0ICogQHBhcmFtIGJ1dHRvblxuXHRcdCAqIEBwYXJhbSBzaG93TWVzc2FnZXNcblx0XHQgKlxuXHRcdCAqIEByZXR1cm4gb2JqZWN0XG5cdFx0ICovXG5cdFx0YWpheDogZnVuY3Rpb24gKGRhdGEsIGJ1dHRvbiA9IG51bGwsIHNob3dNZXNzYWdlcyA9IHRydWUpIHtcblx0XHRcdHJldHVybiBmZXRjaChcblx0XHRcdFx0YWpheHVybCxcblx0XHRcdFx0e1xuXHRcdFx0XHRcdG1ldGhvZDogJ1BPU1QnLFxuXHRcdFx0XHRcdGJvZHk6IGRhdGEsXG5cdFx0XHRcdH1cblx0XHRcdCkudGhlbihyZXNwb25zZSA9PiB7XG5cdFx0XHRcdGlmIChidXR0b24pIHtcblx0XHRcdFx0XHRpZiAoYnV0dG9uLmNoaWxkcmVuLmxlbmd0aCA+IDApIHtcblx0XHRcdFx0XHRcdGJ1dHRvbi5jaGlsZHJlblswXS5jbGFzc0xpc3QgKz0gJyBoaWRkZW4nO1xuXHRcdFx0XHRcdH1cblxuXHRcdFx0XHRcdGlmIChidXR0b24uaWQgPT09ICdjb25uZWN0X3BsYXVzaWJsZV9hbmFseXRpY3MnICYmIHJlc3BvbnNlLnN0YXR1cyA9PT0gMjAwKSB7XG5cdFx0XHRcdFx0XHRidXR0b24uaW5uZXJUZXh0ID0gcGxhdXNpYmxlX2FuYWx5dGljc19pMThuLmNvbm5lY3RlZDtcblx0XHRcdFx0XHR9IGVsc2Uge1xuXHRcdFx0XHRcdFx0YnV0dG9uLnJlbW92ZUF0dHJpYnV0ZSgnZGlzYWJsZWQnKTtcblx0XHRcdFx0XHR9XG5cdFx0XHRcdH1cblxuXHRcdFx0XHRpZiAocmVzcG9uc2Uuc3RhdHVzID09PSAyMDApIHtcblx0XHRcdFx0XHRyZXR1cm4gcmVzcG9uc2UuanNvbigpO1xuXHRcdFx0XHR9XG5cblx0XHRcdFx0cmV0dXJuIGZhbHNlO1xuXHRcdFx0fSkudGhlbihyZXNwb25zZSA9PiB7XG5cdFx0XHRcdGlmIChzaG93TWVzc2FnZXMgPT09IHRydWUpIHtcblx0XHRcdFx0XHRwbGF1c2libGUuc2hvd01lc3NhZ2VzKCk7XG5cdFx0XHRcdH1cblxuXHRcdFx0XHRsZXQgZXZlbnQgPSBuZXcgQ3VzdG9tRXZlbnQoJ3BsYXVzaWJsZUFqYXhEb25lJywge2RldGFpbDogcmVzcG9uc2V9KTtcblxuXHRcdFx0XHRkb2N1bWVudC5kaXNwYXRjaEV2ZW50KGV2ZW50KTtcblxuXHRcdFx0XHRpZiAocmVzcG9uc2UuZGF0YSAhPT0gdW5kZWZpbmVkKSB7XG5cdFx0XHRcdFx0cmV0dXJuIHJlc3BvbnNlLmRhdGE7XG5cdFx0XHRcdH0gZWxzZSB7XG5cdFx0XHRcdFx0cmV0dXJuIHJlc3BvbnNlO1xuXHRcdFx0XHR9XG5cdFx0XHR9KTtcblx0XHR9LFxuXG5cdFx0LyoqXG5cdFx0ICogU2hvdyBtZXNzYWdlcyBvbiBzY3JlZW4uXG5cdFx0ICovXG5cdFx0c2hvd01lc3NhZ2VzOiBmdW5jdGlvbiAoKSB7XG5cdFx0XHRsZXQgbWVzc2FnZXMgPSBwbGF1c2libGUuZmV0Y2hNZXNzYWdlcygpO1xuXG5cdFx0XHRtZXNzYWdlcy50aGVuKGZ1bmN0aW9uIChtZXNzYWdlcykge1xuXHRcdFx0XHRpZiAobWVzc2FnZXMuZXJyb3IgIT09IGZhbHNlKSB7XG5cdFx0XHRcdFx0cGxhdXNpYmxlLnNob3dNZXNzYWdlKG1lc3NhZ2VzLmVycm9yLCAnZXJyb3InKTtcblx0XHRcdFx0fSBlbHNlIGlmIChtZXNzYWdlcy5ub3RpY2UgIT09IGZhbHNlKSB7XG5cdFx0XHRcdFx0cGxhdXNpYmxlLnNob3dNZXNzYWdlKG1lc3NhZ2VzLm5vdGljZSwgJ25vdGljZScpO1xuXHRcdFx0XHR9IGVsc2UgaWYgKG1lc3NhZ2VzLnN1Y2Nlc3MgIT09IGZhbHNlKSB7XG5cdFx0XHRcdFx0cGxhdXNpYmxlLnNob3dNZXNzYWdlKG1lc3NhZ2VzLnN1Y2Nlc3MsICdzdWNjZXNzJyk7XG5cdFx0XHRcdH1cblxuXHRcdFx0XHRpZiAobWVzc2FnZXMuYWRkaXRpb25hbC5sZW5ndGggPT09IDAgfHwgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3BsYXVzaWJsZS1hbmFseXRpY3Mtd2l6YXJkJykgIT09IG51bGwpIHtcblx0XHRcdFx0XHRyZXR1cm47XG5cdFx0XHRcdH1cblxuXHRcdFx0XHRpZiAobWVzc2FnZXMuYWRkaXRpb25hbC5pZCAhPT0gdW5kZWZpbmVkICYmIG1lc3NhZ2VzLmFkZGl0aW9uYWwubWVzc2FnZSkge1xuXHRcdFx0XHRcdHBsYXVzaWJsZS5zaG93QWRkaXRpb25hbE1lc3NhZ2UobWVzc2FnZXMuYWRkaXRpb25hbC5tZXNzYWdlLCBtZXNzYWdlcy5hZGRpdGlvbmFsLmlkKTtcblx0XHRcdFx0fSBlbHNlIGlmIChtZXNzYWdlcy5hZGRpdGlvbmFsLmlkICE9PSB1bmRlZmluZWQgJiYgbWVzc2FnZXMuYWRkaXRpb25hbC5tZXNzYWdlID09PSAnJykge1xuXHRcdFx0XHRcdHBsYXVzaWJsZS5yZW1vdmVBZGRpdGlvbmFsTWVzc2FnZShtZXNzYWdlcy5hZGRpdGlvbmFsLmlkKTtcblx0XHRcdFx0fVxuXHRcdFx0fSk7XG5cdFx0fSxcblxuXHRcdC8qKlxuXHRcdCAqIEZldGNoIHRoZSBtZXNzYWdlcyBmb3IgZGlzcGxheS5cblx0XHQgKi9cblx0XHRmZXRjaE1lc3NhZ2VzOiBmdW5jdGlvbiAoKSB7XG5cdFx0XHRsZXQgZGF0YSA9IG5ldyBGb3JtRGF0YSgpO1xuXHRcdFx0ZGF0YS5hcHBlbmQoJ2FjdGlvbicsICdwbGF1c2libGVfYW5hbHl0aWNzX21lc3NhZ2VzJyk7XG5cblx0XHRcdGxldCByZXN1bHQgPSBwbGF1c2libGUuYWpheChkYXRhLCBudWxsLCBmYWxzZSk7XG5cblx0XHRcdHJldHVybiByZXN1bHQudGhlbihmdW5jdGlvbiAocmVzcG9uc2UpIHtcblx0XHRcdFx0cmV0dXJuIHJlc3BvbnNlO1xuXHRcdFx0fSk7XG5cdFx0fSxcblxuXHRcdC8qKlxuXHRcdCAqIERpc3BsYXlzIGEgbm90aWNlIG9yIGVycm9yIG1lc3NhZ2UuXG5cdFx0ICpcblx0XHQgKiBAcGFyYW0gbWVzc2FnZVxuXHRcdCAqIEBwYXJhbSB0eXBlIGVycm9yfHdhcm5pbmd8c3VjY2VzcyBEZWZhdWx0cyB0byBzdWNjZXNzLlxuXHRcdCAqL1xuXHRcdHNob3dNZXNzYWdlOiBmdW5jdGlvbiAobWVzc2FnZSwgdHlwZSA9ICdzdWNjZXNzJykge1xuXHRcdFx0aWYgKHR5cGUgPT09ICdlcnJvcicpIHtcblx0XHRcdFx0ZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2ljb24tZXJyb3InKS5jbGFzc0xpc3QucmVtb3ZlKCdoaWRkZW4nKTtcblx0XHRcdFx0ZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2ljb24tc3VjY2VzcycpLmNsYXNzTGlzdC5hZGQoJ2hpZGRlbicpO1xuXHRcdFx0XHRkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnaWNvbi1ub3RpY2UnKS5jbGFzc0xpc3QuYWRkKCdoaWRkZW4nKTtcblx0XHRcdH0gZWxzZSBpZiAodHlwZSA9PT0gJ25vdGljZScpIHtcblx0XHRcdFx0ZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2ljb24tbm90aWNlJykuY2xhc3NMaXN0LnJlbW92ZSgnaGlkZGVuJyk7XG5cdFx0XHRcdGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdpY29uLWVycm9yJykuY2xhc3NMaXN0LmFkZCgnaGlkZGVuJyk7XG5cdFx0XHRcdGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdpY29uLXN1Y2Nlc3MnKS5jbGFzc0xpc3QuYWRkKCdoaWRkZW4nKTtcblx0XHRcdH0gZWxzZSB7XG5cdFx0XHRcdGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdpY29uLXN1Y2Nlc3MnKS5jbGFzc0xpc3QucmVtb3ZlKCdoaWRkZW4nKTtcblx0XHRcdFx0ZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2ljb24tZXJyb3InKS5jbGFzc0xpc3QuYWRkKCdoaWRkZW4nKTtcblx0XHRcdFx0ZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2ljb24tbm90aWNlJykuY2xhc3NMaXN0LmFkZCgnaGlkZGVuJyk7XG5cdFx0XHR9XG5cblx0XHRcdGxldCBub3RpY2UgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgncGxhdXNpYmxlLWFuYWx5dGljcy1ub3RpY2UnKTtcblxuXHRcdFx0ZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3BsYXVzaWJsZS1hbmFseXRpY3Mtbm90aWNlLXRleHQnKS5pbm5lckhUTUwgPSBtZXNzYWdlO1xuXG5cdFx0XHRub3RpY2UuY2xhc3NMaXN0LnJlbW92ZSgnaGlkZGVuJyk7XG5cblx0XHRcdHNldFRpbWVvdXQoZnVuY3Rpb24gKCkge1xuXHRcdFx0XHRub3RpY2UuY2xhc3NMaXN0LnJlcGxhY2UoJ29wYWNpdHktMCcsICdvcGFjaXR5LTEwMCcpO1xuXHRcdFx0fSwgMjAwKVxuXG5cdFx0XHRpZiAodHlwZSAhPT0gJ2Vycm9yJykge1xuXHRcdFx0XHRzZXRUaW1lb3V0KGZ1bmN0aW9uICgpIHtcblx0XHRcdFx0XHRub3RpY2UuY2xhc3NMaXN0LnJlcGxhY2UoJ29wYWNpdHktMTAwJywgJ29wYWNpdHktMCcpO1xuXHRcdFx0XHRcdHNldFRpbWVvdXQoZnVuY3Rpb24gKCkge1xuXHRcdFx0XHRcdFx0bm90aWNlLmNsYXNzTGlzdCArPSAnIGhpZGRlbic7XG5cdFx0XHRcdFx0fSwgMjAwKVxuXHRcdFx0XHR9LCAyMDAwKTtcblx0XHRcdH1cblx0XHR9LFxuXHRcdC8qKlxuXHRcdCAqIFJlbmRlcnMgYSBIVE1MIGJveCBjb250YWluaW5nIGFkZGl0aW9uYWwgaW5mb3JtYXRpb24gYWJvdXQgdGhlIGVuYWJsZWQgb3B0aW9uLlxuXHRcdCAqXG5cdFx0ICogQHBhcmFtIGh0bWxcblx0XHQgKiBAcGFyYW0gdGFyZ2V0XG5cdFx0ICovXG5cdFx0c2hvd0FkZGl0aW9uYWxNZXNzYWdlOiBmdW5jdGlvbiAoaHRtbCwgdGFyZ2V0KSB7XG5cdFx0XHRsZXQgdGFyZ2V0RWxlbSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoYFtuYW1lPScke3RhcmdldH0nXWApO1xuXHRcdFx0bGV0IGNvbnRhaW5lciA9IHRhcmdldEVsZW0uY2xvc2VzdCgnLnBsYXVzaWJsZS1hbmFseXRpY3MtZ3JvdXAnKTtcblxuXHRcdFx0Y29udGFpbmVyLmlubmVySFRNTCArPSBodG1sO1xuXHRcdH0sXG5cblx0XHQvKipcblx0XHQgKiBSZW1vdmVzIHRoZSBhZGRpdGlvbmFsIGluZm9ybWF0aW9uIGJveCB3aGVuIHRoZSBvcHRpb24gaXMgZGlzYWJsZWQuXG5cdFx0ICpcblx0XHQgKiBAcGFyYW0gdGFyZ2V0XG5cdFx0ICovXG5cdFx0cmVtb3ZlQWRkaXRpb25hbE1lc3NhZ2U6IGZ1bmN0aW9uICh0YXJnZXQpIHtcblx0XHRcdGxldCB0YXJnZXRFbGVtID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihgW25hbWU9XCIke3RhcmdldH1cIl1gKTtcblx0XHRcdGxldCBjb250YWluZXIgPSB0YXJnZXRFbGVtLmNsb3Nlc3QoJy5wbGF1c2libGUtYW5hbHl0aWNzLWdyb3VwJyk7XG5cdFx0XHRsZXQgYWRkaXRpb25hbE1lc3NhZ2U7XG5cblx0XHRcdGlmIChjb250YWluZXIuY2hpbGRyZW4ubGVuZ3RoID4gMCkge1xuXHRcdFx0XHRmb3IgKGxldCBpID0gMDsgaSA8IGNvbnRhaW5lci5jaGlsZHJlbi5sZW5ndGg7IGkrKykge1xuXHRcdFx0XHRcdGlmIChjb250YWluZXIuY2hpbGRyZW5baV0uY2xhc3NMaXN0LmNvbnRhaW5zKCdwbGF1c2libGUtYW5hbHl0aWNzLWhvb2snKSkge1xuXHRcdFx0XHRcdFx0YWRkaXRpb25hbE1lc3NhZ2UgPSBjb250YWluZXIuY2hpbGRyZW5baV07XG5cblx0XHRcdFx0XHRcdGJyZWFrO1xuXHRcdFx0XHRcdH1cblx0XHRcdFx0fVxuXHRcdFx0fVxuXG5cdFx0XHRpZiAoYWRkaXRpb25hbE1lc3NhZ2UgIT09IHVuZGVmaW5lZCkge1xuXHRcdFx0XHRjb250YWluZXIucmVtb3ZlQ2hpbGQoYWRkaXRpb25hbE1lc3NhZ2UpO1xuXHRcdFx0fVxuXHRcdH1cblx0fVxuXG5cdHBsYXVzaWJsZS5pbml0KCk7XG59KTtcbiJdLCJuYW1lcyI6WyJkb2N1bWVudCIsImFkZEV2ZW50TGlzdGVuZXIiLCJsb2NhdGlvbiIsImhyZWYiLCJpbmNsdWRlcyIsInBsYXVzaWJsZSIsIm5vbmNlRWxlbSIsImdldEVsZW1lbnRCeUlkIiwibm9uY2UiLCJzaG93V2l6YXJkRWxlbSIsImRvbWFpbk5hbWVFbGVtIiwiYXBpVG9rZW5FbGVtIiwiY3JlYXRlQVBJVG9rZW5FbGVtcyIsImdldEVsZW1lbnRzQnlDbGFzc05hbWUiLCJidXR0b25FbGVtcyIsInN0ZXBFbGVtcyIsImluaXQiLCJoYXNoIiwidGhpcyIsInZhbHVlIiwidG9nZ2xlV2l6YXJkU3RlcCIsIndpbmRvdyIsInNob3dXaXphcmQiLCJkaXNhYmxlQ29ubmVjdEJ1dHRvbiIsImxlbmd0aCIsImkiLCJjcmVhdGVBUElUb2tlbiIsInNhdmVPcHRpb24iLCJ0b2dnbGVPcHRpb24iLCJzYXZlT3B0aW9uT25OZXh0Iiwic2hvd01lc3NhZ2VzIiwiZSIsInRhcmdldCIsImNsYXNzTGlzdCIsImNvbnRhaW5zIiwidG9nZ2xlIiwidG9nZ2xlU3RhdHVzIiwiYnV0dG9uIiwiY2xvc2VzdCIsInR5cGUiLCJxdWVyeVNlbGVjdG9yIiwicmVwbGFjZSIsImZvcm0iLCJGb3JtRGF0YSIsImFwcGVuZCIsIm5hbWUiLCJuZXh0RWxlbWVudFNpYmxpbmciLCJpbm5lckhUTUwiLCJkYXRhc2V0IiwibGlzdCIsImFqYXgiLCJpbnB1dHMiLCJxdWVyeVNlbGVjdG9yQWxsIiwib3B0aW9ucyIsImZvckVhY2giLCJpbnB1dCIsInB1c2giLCJKU09OIiwic3RyaW5naWZ5IiwiY2hpbGRyZW4iLCJyZW1vdmUiLCJzZXRBdHRyaWJ1dGUiLCJfc3RlcCIsIl9pdGVyYXRvciIsIl9jcmVhdGVGb3JPZkl0ZXJhdG9ySGVscGVyIiwiZ2V0RWxlbWVudHNCeVRhZ05hbWUiLCJzIiwibiIsImRvbmUiLCJlcnIiLCJmIiwiZGF0YSIsInRoZW4iLCJyZXNwb25zZSIsInN1Y2Nlc3MiLCJyZW1vdmVBdHRyaWJ1dGUiLCJidXR0b25Jc0hyZWYiLCJzbGlkZV9pZCIsImRpc2FibGVkIiwicHJldmVudERlZmF1bHQiLCJkb21haW4iLCJvcGVuIiwiY29uY2F0IiwicGxhdXNpYmxlX2FuYWx5dGljc19ob3N0ZWRfZG9tYWluIiwic3Vic3RyaW5nIiwiYWxsU3RlcHMiLCJhY3RpdmVTdGVwcyIsImNvbXBsZXRlZFN0ZXBzIiwiY3VycmVudFN0ZXAiLCJpbmFjdGl2ZUN1cnJlbnRTdGVwIiwiY3VycmVudGx5Q29tcGxldGVkU3RlcHMiLCJzcGxpdCIsImZpbHRlciIsInN0ZXAiLCJjb21wbGV0ZWRTdGVwIiwiaW5hY3RpdmVTdGVwIiwiYXJndW1lbnRzIiwidW5kZWZpbmVkIiwiZmV0Y2giLCJhamF4dXJsIiwibWV0aG9kIiwiYm9keSIsImlkIiwic3RhdHVzIiwiaW5uZXJUZXh0IiwicGxhdXNpYmxlX2FuYWx5dGljc19pMThuIiwiY29ubmVjdGVkIiwianNvbiIsImV2ZW50IiwiQ3VzdG9tRXZlbnQiLCJkZXRhaWwiLCJkaXNwYXRjaEV2ZW50IiwiZmV0Y2hNZXNzYWdlcyIsIm1lc3NhZ2VzIiwiZXJyb3IiLCJzaG93TWVzc2FnZSIsIm5vdGljZSIsImFkZGl0aW9uYWwiLCJtZXNzYWdlIiwic2hvd0FkZGl0aW9uYWxNZXNzYWdlIiwicmVtb3ZlQWRkaXRpb25hbE1lc3NhZ2UiLCJhZGQiLCJzZXRUaW1lb3V0IiwiaHRtbCIsImFkZGl0aW9uYWxNZXNzYWdlIiwiY29udGFpbmVyIiwicmVtb3ZlQ2hpbGQiXSwic291cmNlUm9vdCI6IiJ9