/*! For license information please see gp-google-sheets-settings-feed.js.LICENSE.txt */
(()=>{"use strict";var __webpack_modules__={251:(e,t,n)=>{var o=n(196),r=Symbol.for("react.element"),s=(Symbol.for("react.fragment"),Object.prototype.hasOwnProperty),i=o.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,a={key:!0,ref:!0,__self:!0,__source:!0};function c(e,t,n){var o,c={},u=null,l=null;for(o in void 0!==n&&(u=""+n),void 0!==t.key&&(u=""+t.key),void 0!==t.ref&&(l=t.ref),t)s.call(t,o)&&!a.hasOwnProperty(o)&&(c[o]=t[o]);if(e&&e.defaultProps)for(o in t=e.defaultProps)void 0===c[o]&&(c[o]=t[o]);return{$$typeof:r,type:e,key:u,ref:l,props:c,_owner:i.current}}t.jsx=c,t.jsxs=c},893:(e,t,n)=>{e.exports=n(251)},833:(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{$_:()=>updateColumnMappingSection,fh:()=>disableColumnMappingSection,p0:()=>enableColumnMappingSection});var jquery__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(567),jquery__WEBPACK_IMPORTED_MODULE_0___default=__webpack_require__.n(jquery__WEBPACK_IMPORTED_MODULE_0__),strings=window.gpgs_settings_strings;function disableSettingsSection(e){jquery__WEBPACK_IMPORTED_MODULE_0___default()(e).addClass("gpgs-disabled-settings-section").attr("inert","true")}function enableSettingsSection(e){jquery__WEBPACK_IMPORTED_MODULE_0___default()(e).removeClass("gpgs-disabled-settings-section").removeAttr("inert")}function disableColumnMappingSection(){disableSettingsSection("#gform-settings-section-column-mapping")}function enableColumnMappingSection(){enableSettingsSection("#gform-settings-section-column-mapping")}function updateColumnMappingSection(_a){var sheetId=_a.sheetId,sheetName=_a.sheetName,sheetUrl=_a.sheetUrl;jQuery.get(strings.ajax_url,{action:"gpgs_select_sheet",_ajax_nonce:strings.nonce,id:strings.form_id,feed_id:strings.feed_id,sheet_url:sheetUrl,sheet_id:sheetId,sheet_name:sheetName},(function(response){var matches=response.data.controlsHTML.match(/<script type=\"text\/javascript\">(.+)<\/script>/);if(null==matches?void 0:matches.length){var controlsHTML=response.data.controlsHTML.replace(matches[0],"");jquery__WEBPACK_IMPORTED_MODULE_0___default()("#gform_setting_column_mapping").html(controlsHTML),enableColumnMappingSection();try{eval(matches[1])}catch(e){console.warn(e)}}}))}},250:(e,t,n)=>{var o=n(196),r="function"==typeof Object.is?Object.is:function(e,t){return e===t&&(0!==e||1/e==1/t)||e!=e&&t!=t},s=o.useState,i=o.useEffect,a=o.useLayoutEffect,c=o.useDebugValue;function u(e){var t=e.getSnapshot;e=e.value;try{var n=t();return!r(e,n)}catch(e){return!0}}var l="undefined"==typeof window||void 0===window.document||void 0===window.document.createElement?function(e,t){return t()}:function(e,t){var n=t(),o=s({inst:{value:n,getSnapshot:t}}),r=o[0].inst,l=o[1];return a((function(){r.value=n,r.getSnapshot=t,u(r)&&l({inst:r})}),[e,n,t]),i((function(){return u(r)&&l({inst:r}),e((function(){u(r)&&l({inst:r})}))}),[e]),c(n),n};t.useSyncExternalStore=void 0!==o.useSyncExternalStore?o.useSyncExternalStore:l},139:(e,t,n)=>{var o=n(196),r=n(688),s="function"==typeof Object.is?Object.is:function(e,t){return e===t&&(0!==e||1/e==1/t)||e!=e&&t!=t},i=r.useSyncExternalStore,a=o.useRef,c=o.useEffect,u=o.useMemo,l=o.useDebugValue;t.useSyncExternalStoreWithSelector=function(e,t,n,o,r){var d=a(null);if(null===d.current){var g={hasValue:!1,value:null};d.current=g}else g=d.current;d=u((function(){function e(e){if(!c){if(c=!0,i=e,e=o(e),void 0!==r&&g.hasValue){var t=g.value;if(r(t,e))return a=t}return a=e}if(t=a,s(i,e))return t;var n=o(e);return void 0!==r&&r(t,n)?t:(i=e,a=n)}var i,a,c=!1,u=void 0===n?null:n;return[function(){return e(t())},null===u?void 0:function(){return e(u())}]}),[t,n,o,r]);var f=i(e,d[0],d[1]);return c((function(){g.hasValue=!0,g.value=f}),[f]),l(f),f}},688:(e,t,n)=>{e.exports=n(250)},798:(e,t,n)=>{e.exports=n(139)},196:e=>{e.exports=window.React},567:e=>{e.exports=window.jQuery}},__webpack_module_cache__={};function __webpack_require__(e){var t=__webpack_module_cache__[e];if(void 0!==t)return t.exports;var n=__webpack_module_cache__[e]={exports:{}};return __webpack_modules__[e](n,n.exports,__webpack_require__),n.exports}__webpack_require__.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return __webpack_require__.d(t,{a:t}),t},__webpack_require__.d=(e,t)=>{for(var n in t)__webpack_require__.o(t,n)&&!__webpack_require__.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})},__webpack_require__.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t);var __webpack_exports__={};(()=>{var e=__webpack_require__(893);const t=window.wp.element;var n=__webpack_require__(196),o=__webpack_require__.n(n);const r=window.wp.i18n,s=function(t){var o=t.content;return(0,n.useEffect)((function(){window.gform_initialize_tooltips()}),[]),(0,e.jsx)("button",{onClick:function(e){e.preventDefault()},onKeyPress:function(e){e.preventDefault()},className:"gf_tooltip tooltip ","aria-label":o,children:(0,e.jsx)("i",{className:"gform-icon gform-icon--question-mark","aria-hidden":"true"})})},i=function(t){var n=t.name,o=t.label,i=t.value,a=t.required,c=t.tooltip,u=t.options,l=t.placeholder,d=t.disabled,g=t.onChange;return(0,e.jsxs)("div",{id:"gform_setting_".concat(n),className:"gform-settings-field gform-settings-field__select",children:[(0,e.jsxs)("div",{className:"gform-settings-field__header",children:[(0,e.jsxs)("label",{className:"gform-settings-label",htmlFor:n,children:[o,a&&(0,e.jsxs)("span",{className:"required",children:["(",(0,r.__)("Required"),")"]})]})," ",c&&(0,e.jsx)(s,{content:c})]}),(0,e.jsx)("span",{className:"gform-settings-input__container",children:(0,e.jsxs)("select",{name:"_gform_setting_".concat(n),required:a,id:n,value:i,disabled:d,onChange:function(e){return g(e.target.value)},children:[l&&(0,e.jsx)("option",{value:"",disabled:!0,children:l}),u.map((function(t){return"options"in t?(0,e.jsx)("optgroup",{label:t.text,children:t.options.map((function(t){return(0,e.jsx)("option",{value:t.value,children:t.text},t.value)}))},t.text):(0,e.jsx)("option",{value:t.value,children:t.text},t.value)}))]})})]})},a=e=>{let t;const n=new Set,o=(e,o)=>{const r="function"==typeof e?e(t):e;if(!Object.is(r,t)){const e=t;t=(null!=o?o:"object"!=typeof r)?r:Object.assign({},t,r),n.forEach((n=>n(t,e)))}},r=()=>t,s={setState:o,getState:r,subscribe:e=>(n.add(e),()=>n.delete(e)),destroy:()=>{console.warn("[DEPRECATED] The `destroy` method will be unsupported in a future version. Instead use unsubscribe function returned by subscribe. Everything will be garbage-collected if store is garbage-collected."),n.clear()}};return t=e(o,r,s),s};var c=__webpack_require__(798);const{useSyncExternalStoreWithSelector:u}=c;let l=!1;const d=e=>{"function"!=typeof e&&console.warn("[DEPRECATED] Passing a vanilla store will be unsupported in a future version. Instead use `import { useStore } from 'zustand'`.");const t="function"==typeof e?(e=>e?a(e):a)(e):e,o=(e,o)=>function(e,t=e.getState,o){o&&!l&&(console.warn("[DEPRECATED] Use `createWithEqualityFn` instead of `create` or use `useStoreWithEqualityFn` instead of `useStore`. They can be imported from 'zustand/traditional'. https://github.com/pmndrs/zustand/discussions/1937"),l=!0);const r=u(e.subscribe,e.getState,e.getServerState||e.getState,t,o);return(0,n.useDebugValue)(r),r}(t,e,o);return Object.assign(o,t),o};var g=function(e,t,n){if(n||2===arguments.length)for(var o,r=0,s=t.length;r<s;r++)!o&&r in t||(o||(o=Array.prototype.slice.call(t,0,r)),o[r]=t[r]);return e.concat(o||Array.prototype.slice.call(t))},f=function(e){return{notices:[],clearNotices:function(){return e({notices:[]})},addNotice:function(t){return e((function(e){return{notices:g(g([],e.notices,!0),[t],!1)}}))},setNotice:function(t){return e({notices:[t]})},setErrorNotice:function(t){return e({notices:[{type:"error",message:t}]})},setSuccessNotice:function(t){return e({notices:[{type:"success",message:t}]})}}},p=function(e,t,n,o){return new(n||(n=Promise))((function(r,s){function i(e){try{c(o.next(e))}catch(e){s(e)}}function a(e){try{c(o.throw(e))}catch(e){s(e)}}function c(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(i,a)}c((o=o.apply(e,t||[])).next())}))},_=function(e,t){var n,o,r,s,i={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return s={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(s[Symbol.iterator]=function(){return this}),s;function a(a){return function(c){return function(a){if(n)throw new TypeError("Generator is already executing.");for(;s&&(s=0,a[0]&&(i=0)),i;)try{if(n=1,o&&(r=2&a[0]?o.return:a[0]?o.throw||((r=o.return)&&r.call(o),0):o.next)&&!(r=r.call(o,a[1])).done)return r;switch(o=0,r&&(a=[2&a[0],r.value]),a[0]){case 0:case 1:r=a;break;case 4:return i.label++,{value:a[1],done:!1};case 5:i.label++,o=a[1],a=[0];continue;case 7:a=i.ops.pop(),i.trys.pop();continue;default:if(!((r=(r=i.trys).length>0&&r[r.length-1])||6!==a[0]&&2!==a[0])){i=0;continue}if(3===a[0]&&(!r||a[1]>r[0]&&a[1]<r[3])){i.label=a[1];break}if(6===a[0]&&i.label<r[1]){i.label=r[1],r=a;break}if(r&&i.label<r[2]){i.label=r[2],i.ops.push(a);break}r[2]&&i.ops.pop(),i.trys.pop();continue}a=t.call(e,i)}catch(e){a=[6,e],o=0}finally{n=r=0}if(5&a[0])throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}([a,c])}}},h=window.gpgs_settings_strings,v=function(e,t){var n,o,s;return{isDisconnecting:!1,googleAccount:void 0,connected:!!(null===(n=document.querySelector("input#google_sheet_url"))||void 0===n?void 0:n.value),googleSheetUrl:null===(o=document.querySelector("input#google_sheet_url"))||void 0===o?void 0:o.value,googleSpreadsheetId:void 0,googleSheetId:null===(s=document.querySelector("input#google_sheet_id"))||void 0===s?void 0:s.value,googleSpreadsheetName:h.spreadsheet_name,googleSheetName:h.sheet_name,googleErrorMessage:h.error_message,disconnectFeed:function(){return p(void 0,void 0,void 0,(function(){var n,o;return _(this,(function(s){switch(s.label){case 0:if(t().isDisconnecting)return[2];t().clearNotices(),e({isDisconnecting:!0}),n=(0,r.__)("An error occurred while disconnecting this feed.","gp-google-sheets"),s.label=1;case 1:return s.trys.push([1,3,4,5]),[4,jQuery.post(h.ajax_url,{action:"gpgs_disconnect",_ajax_nonce:h.nonce,form_id:h.form_id,feed_id:h.feed_id})];case 2:return s.sent().success?(e({googleSheetUrl:void 0,connected:!1,googleSpreadsheetId:void 0,googleSheetId:void 0,googleSpreadsheetName:void 0,googleSheetName:void 0}),t().setSuccessNotice((0,r.__)("Successfully disconnected feed.","gp-google-sheets")),[3,5]):(t().setErrorNotice(n),[2]);case 3:return(o=s.sent()).status>=400?(t().setErrorNotice((0,r.sprintf)((0,r.__)("An error occurred while disconnecting this feed. Please try again. If the problem persists, please contact support. Error: %s","gp-google-sheets"),o.statusText)),[2]):(t().setErrorNotice(n),[3,5]);case 4:return e({isDisconnecting:!1}),[7];case 5:return[2]}}))}))},setGoogleAccount:function(n){e({googleAccount:n,googleSpreadsheetId:void 0,googleSheetId:void 0}),t().fetchSpreadsheets(n)},setGoogleSpreadsheetId:function(n){return p(void 0,void 0,void 0,(function(){var o,r,s,i,a,c;return _(this,(function(u){switch(u.label){case 0:return e({googleSpreadsheetId:n,googleSheetId:void 0}),n&&"add"!==n&&"select"!==n?[4,t().fetchSheets(n)]:[2];case 1:return u.sent(),(o=t().sheets[n])?((r=Object.values(o).find((function(e){return"Sheet1"===e.title})))&&e({googleSheetId:r.id}),(s=t().googleAccount)&&(i=null===(a=t().spreadsheets)||void 0===a?void 0:a[s])&&"string"!=typeof i?(e({googleSheetUrl:null===(c=i.find((function(e){return e.id===n})))||void 0===c?void 0:c.webViewLink}),[2]):[2]):[2]}}))}))},setGoogleSheetId:function(t){e({googleSheetId:t})}}},b=function(){return b=Object.assign||function(e){for(var t,n=1,o=arguments.length;n<o;n++)for(var r in t=arguments[n])Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e},b.apply(this,arguments)},y=function(e,t,n,o){return new(n||(n=Promise))((function(r,s){function i(e){try{c(o.next(e))}catch(e){s(e)}}function a(e){try{c(o.throw(e))}catch(e){s(e)}}function c(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(i,a)}c((o=o.apply(e,t||[])).next())}))},m=function(e,t){var n,o,r,s,i={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return s={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(s[Symbol.iterator]=function(){return this}),s;function a(a){return function(c){return function(a){if(n)throw new TypeError("Generator is already executing.");for(;s&&(s=0,a[0]&&(i=0)),i;)try{if(n=1,o&&(r=2&a[0]?o.return:a[0]?o.throw||((r=o.return)&&r.call(o),0):o.next)&&!(r=r.call(o,a[1])).done)return r;switch(o=0,r&&(a=[2&a[0],r.value]),a[0]){case 0:case 1:r=a;break;case 4:return i.label++,{value:a[1],done:!1};case 5:i.label++,o=a[1],a=[0];continue;case 7:a=i.ops.pop(),i.trys.pop();continue;default:if(!((r=(r=i.trys).length>0&&r[r.length-1])||6!==a[0]&&2!==a[0])){i=0;continue}if(3===a[0]&&(!r||a[1]>r[0]&&a[1]<r[3])){i.label=a[1];break}if(6===a[0]&&i.label<r[1]){i.label=r[1],r=a;break}if(r&&i.label<r[2]){i.label=r[2],i.ops.push(a);break}r[2]&&i.ops.pop(),i.trys.pop();continue}a=t.call(e,i)}catch(e){a=[6,e],o=0}finally{n=r=0}if(5&a[0])throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}([a,c])}}},w=window.gpgs_settings_strings;w||(w=window.gpgs_settings_plugin_strings);var S=function(e,t){return{spreadsheets:{},sheets:{},fetchSpreadsheets:function(n){return y(void 0,void 0,void 0,(function(){var o,r,s;return m(this,(function(i){switch(i.label){case 0:return[4,jQuery.get(w.ajax_url,{action:"gpgs_get_spreadsheets",_ajax_nonce:w.nonce,google_email:n})];case 1:return(o=i.sent()).success?(e({spreadsheets:b(b({},t().spreadsheets),(s={},s[n]=o.data.spreadsheets,s))}),[2]):(e({spreadsheets:b(b({},t().spreadsheets),(r={},r[n]=o.data.message,r))}),[2])}}))}))},refetchSpreadsheets:function(n){return y(void 0,void 0,void 0,(function(){var o;return m(this,(function(r){switch(r.label){case 0:return e({spreadsheets:b(b({},t().spreadsheets),(o={},o[n]=void 0,o))}),[4,t().fetchSpreadsheets(n)];case 1:return r.sent(),[2]}}))}))},fetchSheets:function(n){return y(void 0,void 0,void 0,(function(){var o,r,s;return m(this,(function(i){switch(i.label){case 0:return[4,jQuery.post(w.ajax_url,{action:"gpgs_get_sheets",_ajax_nonce:w.nonce,spreadsheet_id:n})];case 1:return(o=i.sent()).success?(e({sheets:b(b({},t().sheets),(s={},s[n]=o.data.sheets,s))}),[2]):(e({sheets:b(b({},t().sheets),(r={},r[n]=o.data.message,r))}),[2])}}))}))}}},x=__webpack_require__(567),j=__webpack_require__.n(x);function k(e){var t=e.ms,n=void 0===t?1e3:t,o=e.itemKey,r=e.handleItem,s=setInterval((function(){var e=localStorage.getItem(o);e&&(clearInterval(s),r(e))}),n)}function E(e){var t=e.oAuthServiceUrl,n=e.inputs,o=e.id,r=void 0===o?"gpgs_oauth_form":o;j()('<form\n\t\t\tid="'.concat(r,'"\n\t\t\taction="').concat(t,'"\n\t\t\tmethod="POST"\n\t\t\ttarget="tab"\n\t\t>\n\t\t\t').concat(n.map((function(e){var t=e[0],n=e[1].replace(/"/g,"&quot;");return'<input type="hidden" name="'.concat(t,'" value="').concat(n,'">')})),"\n\t\t</form>")).appendTo("body").submit()}var A=window.gpgs_settings_strings;A||(A=window.gpgs_settings_plugin_strings);var I,N=function(e,t){return{googleAccounts:void 0,fetchGoogleAccounts:function(){return t=void 0,n=void 0,r=function(){var t;return function(e,t){var n,o,r,s,i={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return s={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(s[Symbol.iterator]=function(){return this}),s;function a(a){return function(c){return function(a){if(n)throw new TypeError("Generator is already executing.");for(;s&&(s=0,a[0]&&(i=0)),i;)try{if(n=1,o&&(r=2&a[0]?o.return:a[0]?o.throw||((r=o.return)&&r.call(o),0):o.next)&&!(r=r.call(o,a[1])).done)return r;switch(o=0,r&&(a=[2&a[0],r.value]),a[0]){case 0:case 1:r=a;break;case 4:return i.label++,{value:a[1],done:!1};case 5:i.label++,o=a[1],a=[0];continue;case 7:a=i.ops.pop(),i.trys.pop();continue;default:if(!((r=(r=i.trys).length>0&&r[r.length-1])||6!==a[0]&&2!==a[0])){i=0;continue}if(3===a[0]&&(!r||a[1]>r[0]&&a[1]<r[3])){i.label=a[1];break}if(6===a[0]&&i.label<r[1]){i.label=r[1],r=a;break}if(r&&i.label<r[2]){i.label=r[2],i.ops.push(a);break}r[2]&&i.ops.pop(),i.trys.pop();continue}a=t.call(e,i)}catch(e){a=[6,e],o=0}finally{n=r=0}if(5&a[0])throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}([a,c])}}}(this,(function(n){switch(n.label){case 0:return n.trys.push([0,2,,3]),[4,jQuery.get(A.ajax_url,{action:"gpgs_get_google_accounts",_ajax_nonce:A.nonce})];case 1:return(t=n.sent()).success?(e({googleAccounts:t.data.google_accounts}),[3,3]):(e({googleAccounts:[]}),[2]);case 2:return n.sent().status>=400&&e({googleAccounts:[]}),[3,3];case 3:return[2]}}))},new((o=void 0)||(o=Promise))((function(e,s){function i(e){try{c(r.next(e))}catch(e){s(e)}}function a(e){try{c(r.throw(e))}catch(e){s(e)}}function c(t){var n;t.done?e(t.value):(n=t.value,n instanceof o?n:new o((function(e){e(n)}))).then(i,a)}c((r=r.apply(t,n||[])).next())}));var t,n,o,r},addGoogleAccount:function(){return new Promise((function(e,n){!function(e){var t=e.strings,n=e.showErrorMessage,o=e.onDataFound,r=e.actionHandlerName,s="".concat(t.gwiz_oauth_service_url,"/oauth/google"),i=Math.random().toString(36).substring(2,15),a={oauth_random_string:i,oauth_validation_token:t.oauth_validation_token,user_id:t.user_id};E({oAuthServiceUrl:s,inputs:[["licenseId",t.gravity_perks_license_id],["licenseHash",t.gravity_perks_license_hash],["redirectUrl","".concat(t.ajax_url,"?action=").concat(r)],["perkId",t.slug],["siteUrl",t.site_url],["state",JSON.stringify(a)]]});var c="".concat("gpgs_google_oauth_data","_").concat(i);k({itemKey:c,handleItem:function(e){localStorage.removeItem(c);var t=JSON.parse(e);"0"!==t.success&&t.token?o(t):n(t.message)}})}({showErrorMessage:function(e){t().setErrorNotice(e),n(new Error(e))},strings:A,onDataFound:function(n){var o=n.token;o?(t().setSuccessNotice((0,r.__)("Successfully added new Google Account!","gp-google-sheets")),e(o)):t().setErrorNotice((0,r.__)("Failed to get token. Please try again.","gp-google-sheets"))},actionHandlerName:"gpgs_plugin_settings_oauth_callback"})}))}}},O=window.gpgs_settings_strings,T=function(e,t){return{isInsertingTestRow:!1,insertTestRow:function(){var n,o,s,i,a,c;return s=this,i=void 0,c=function(){var s,i;return function(e,t){var n,o,r,s,i={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return s={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(s[Symbol.iterator]=function(){return this}),s;function a(a){return function(c){return function(a){if(n)throw new TypeError("Generator is already executing.");for(;s&&(s=0,a[0]&&(i=0)),i;)try{if(n=1,o&&(r=2&a[0]?o.return:a[0]?o.throw||((r=o.return)&&r.call(o),0):o.next)&&!(r=r.call(o,a[1])).done)return r;switch(o=0,r&&(a=[2&a[0],r.value]),a[0]){case 0:case 1:r=a;break;case 4:return i.label++,{value:a[1],done:!1};case 5:i.label++,o=a[1],a=[0];continue;case 7:a=i.ops.pop(),i.trys.pop();continue;default:if(!((r=(r=i.trys).length>0&&r[r.length-1])||6!==a[0]&&2!==a[0])){i=0;continue}if(3===a[0]&&(!r||a[1]>r[0]&&a[1]<r[3])){i.label=a[1];break}if(6===a[0]&&i.label<r[1]){i.label=r[1],r=a;break}if(r&&i.label<r[2]){i.label=r[2],i.ops.push(a);break}r[2]&&i.ops.pop(),i.trys.pop();continue}a=t.call(e,i)}catch(e){a=[6,e],o=0}finally{n=r=0}if(5&a[0])throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}([a,c])}}}(this,(function(a){switch(a.label){case 0:if(t().isInsertingTestRow)return[2];t().clearNotices(),e({isInsertingTestRow:!0}),a.label=1;case 1:return a.trys.push([1,3,4,5]),[4,jQuery.post(O.ajax_url,{action:"gpgs_insert_test_row",_ajax_nonce:O.nonce,form_id:O.form_id,feed_id:O.feed_id})];case 2:return(s=a.sent()).success?(t().setSuccessNotice((0,r.__)("Successfully inserted a test row.","gp-google-sheets")),[3,5]):(t().setErrorNotice(null!==(o=null===(n=s.data)||void 0===n?void 0:n.message)&&void 0!==o?o:(0,r.__)("An unknown error occurred while inserting a test row.","gp-google-sheets")),[2]);case 3:return(i=a.sent()).status>=400?(t().setErrorNotice((0,r.sprintf)((0,r.__)("An error occurred while adding a test row. Please try again. If the problem persists, please contact support. Error: %s","gp-google-sheets"),i.statusText)),[2]):(t().setErrorNotice((0,r.__)("An unknown error occurred while scanning for issues. Please try again. If the problem persists, please contact support.","gp-google-sheets")),[3,5]);case 4:return e({isInsertingTestRow:!1}),[7];case 5:return[2]}}))},new((a=void 0)||(a=Promise))((function(e,t){function n(e){try{r(c.next(e))}catch(e){t(e)}}function o(e){try{r(c.throw(e))}catch(e){t(e)}}function r(t){var r;t.done?e(t.value):(r=t.value,r instanceof a?r:new a((function(e){e(r)}))).then(n,o)}r((c=c.apply(s,i||[])).next())}))}}},q=function(){return q=Object.assign||function(e){for(var t,n=1,o=arguments.length;n<o;n++)for(var r in t=arguments[n])Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e},q.apply(this,arguments)},P=function(e){var t=e;t.use={};for(var n=function(e){t.use[e]=function(){return t((function(t){return t[e]}))}},o=0,r=Object.keys(t.getState());o<r.length;o++)n(r[o]);return t}((I=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return q(q(q(q(q({},f.apply(void 0,e)),v.apply(void 0,e)),N.apply(void 0,e)),S.apply(void 0,e)),T.apply(void 0,e))})?d(I):d);const D=function(){var t=P.use.isInsertingTestRow(),n=P.use.insertTestRow();return(0,e.jsxs)("button",{id:"insert_test_row",className:"button add-new-h2",onClick:function(e){e.preventDefault(),n()},disabled:t,style:{top:0},children:[(0,r.__)("Insert Test Row","gp-google-sheets"),t&&(0,e.jsx)("span",{className:"spinner spinner_insert_test_row is-active"})]})},M=function(){var t=P.use.isDisconnecting(),n=P.use.disconnectFeed();return(0,e.jsxs)("button",{id:"disconnect",className:"button add-new-h2",style:{top:0},onClick:function(e){e.preventDefault(),n()},disabled:t,children:[(0,r.__)("Disconnect","gp-google-sheets"),t&&(0,e.jsx)("span",{className:"spinner spinner_insert_test_row is-active"})]})},C=function(){var t=P.use.googleSheetUrl(),o=P.use.googleSpreadsheetName(),r=P.use.googleSheetName(),s=P.use.googleErrorMessage(),i=o;r&&(i="".concat(i," (").concat(r,")"));var a=s&&(0,e.jsxs)(n.Fragment,{children:[(0,e.jsx)("div",{dangerouslySetInnerHTML:{__html:s}}),(0,e.jsx)("br",{})]}),c=(0,e.jsx)("span",{children:(0,e.jsx)("a",{href:t,target:"_blank",rel:"noreferrer",children:i})});return s?(0,e.jsxs)("p",{className:"alert error",children:[a,c,(0,e.jsx)("span",{style:{alignSelf:"self-end",marginLeft:"auto !important",verticalAlign:"middle"},children:(0,e.jsx)(M,{})})]}):(0,e.jsxs)("div",{className:"alert gforms_note_success",style:{display:"flex",alignItems:"center",marginBottom:0},children:[c,(0,e.jsxs)("span",{style:{alignSelf:"self-end",marginLeft:"auto",verticalAlign:"middle",display:"flex",gap:"1rem"},children:[(0,e.jsx)(D,{}),(0,e.jsx)(M,{})]})]})},R=window.ReactDOM,U=function(t){var n=t.notices,r=document.getElementById("gf-admin-notices-wrapper");if(!r)return null;var s=function(t){var n=t.notice;return(0,e.jsx)("div",{className:"notice notice-".concat(n.type," gf-notice"),children:(0,e.jsx)("p",{children:n.message})})},i=(0,e.jsx)(o().Fragment,{children:n.map((function(t,n){return(0,e.jsx)(s,{notice:t},n)}))});return(0,R.createPortal)(i,r)};var L=__webpack_require__(833);var F=window.gpgs_settings_strings;const G=function(){var t=P.use.setGoogleSpreadsheetId(),n=P.use.googleSpreadsheetId(),o=P.use.setErrorNotice(),s=P.use.googleAccount(),a=P((function(e){var t,n;if(e.googleAccount)return null===(n=null===(t=e.googleAccounts)||void 0===t?void 0:t.find((function(t){return t.googleEmail===e.googleAccount})))||void 0===n?void 0:n.token})),c=P((function(e){var t;if(e.googleAccount)return null===(t=e.spreadsheets)||void 0===t?void 0:t[e.googleAccount]})),u=P.use.refetchSpreadsheets();return"string"==typeof c?(0,e.jsx)("p",{className:"notice notice-error",children:(0,r.__)("An error occurred while fetching your spreadsheets. Please try again.","gp-google-sheets")}):(0,e.jsx)(i,{name:"google_spreadsheet_id",label:"Spreadsheet",value:null!=n?n:"",onChange:function(e){t(e),"select"===e&&function(e){var t=e.token,n=e.showErrorMessage,o=e.onDataFound,s=e.strings,i=Math.random().toString(36).substring(2,15),a={oauth_random_string:i,oauth_validation_token:s.oauth_validation_token,user_id:s.user_id};E({oAuthServiceUrl:"".concat(s.gwiz_oauth_service_url,"/google/file-picker"),inputs:[["postUrl","".concat(s.ajax_url,"?action=gpgs_picker_callback")],["accessToken",t.access_token],["state",JSON.stringify(a)]],id:"gpgs-google-sheet-picker"});var c="".concat("gpgs_google_picker_data","_").concat(i);k({itemKey:c,handleItem:function(e){localStorage.removeItem(c);var t=JSON.parse(e);"0"!==t.success&&t.sheet_url?o(t):n(t.message||(0,r.__)("Error picking spreadsheet.","gp-google-sheets"))}})}({token:a,showErrorMessage:o,onDataFound:function(e){var n,o,r,i,a=e.sheet_url;return n=void 0,o=void 0,i=function(){return function(e,t){var n,o,r,s,i={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return s={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(s[Symbol.iterator]=function(){return this}),s;function a(a){return function(c){return function(a){if(n)throw new TypeError("Generator is already executing.");for(;s&&(s=0,a[0]&&(i=0)),i;)try{if(n=1,o&&(r=2&a[0]?o.return:a[0]?o.throw||((r=o.return)&&r.call(o),0):o.next)&&!(r=r.call(o,a[1])).done)return r;switch(o=0,r&&(a=[2&a[0],r.value]),a[0]){case 0:case 1:r=a;break;case 4:return i.label++,{value:a[1],done:!1};case 5:i.label++,o=a[1],a=[0];continue;case 7:a=i.ops.pop(),i.trys.pop();continue;default:if(!((r=(r=i.trys).length>0&&r[r.length-1])||6!==a[0]&&2!==a[0])){i=0;continue}if(3===a[0]&&(!r||a[1]>r[0]&&a[1]<r[3])){i.label=a[1];break}if(6===a[0]&&i.label<r[1]){i.label=r[1],r=a;break}if(r&&i.label<r[2]){i.label=r[2],i.ops.push(a);break}r[2]&&i.ops.pop(),i.trys.pop();continue}a=t.call(e,i)}catch(e){a=[6,e],o=0}finally{n=r=0}if(5&a[0])throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}([a,c])}}}(this,(function(e){switch(e.label){case 0:return a?[4,u(s)]:[2];case 1:return e.sent(),t((n=a.split("/")).length>=6?n[5]:null),[2]}var n}))},new((r=void 0)||(r=Promise))((function(e,t){function s(e){try{c(i.next(e))}catch(e){t(e)}}function a(e){try{c(i.throw(e))}catch(e){t(e)}}function c(t){var n;t.done?e(t.value):(n=t.value,n instanceof r?n:new r((function(e){e(n)}))).then(s,a)}c((i=i.apply(n,o||[])).next())}))},strings:F})},tooltip:(0,r.__)("Select the spreadsheet you would like to store Gravity Forms entries in."),placeholder:void 0===c?(0,r.__)("Loading…","gp-google-sheets"):"",disabled:void 0===c,options:[{text:(0,r.__)("Actions","gp-google-sheets"),options:[{text:(0,r.__)("Add New Spreadsheet","gp-google-sheets"),value:"add"},{text:(0,r.__)("Connect Existing Spreadsheet","gp-google-sheets"),value:"select"}]},{text:(0,r.__)("Connected Spreadsheets","gp-google-sheets"),options:"object"==typeof c?c.map((function(e){return{text:e.name,value:e.id}})):[]}]})};const K=function(){var t,o=P.use.googleAccount(),s=P((function(e){var t;return null===(t=e.googleAccounts)||void 0===t?void 0:t.filter((function(e){return!e.isLegacyToken}))})),a=P.use.fetchGoogleAccounts(),c=P.use.setGoogleAccount(),u=P.use.addGoogleAccount();return(0,n.useEffect)((function(){a()}),[a]),(0,e.jsx)(i,{name:"google_sheet_account",label:"Account",value:null!=o?o:"",onChange:function(e){return t=void 0,n=void 0,r=function(){var t,n,o;return function(e,t){var n,o,r,s,i={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return s={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(s[Symbol.iterator]=function(){return this}),s;function a(a){return function(c){return function(a){if(n)throw new TypeError("Generator is already executing.");for(;s&&(s=0,a[0]&&(i=0)),i;)try{if(n=1,o&&(r=2&a[0]?o.return:a[0]?o.throw||((r=o.return)&&r.call(o),0):o.next)&&!(r=r.call(o,a[1])).done)return r;switch(o=0,r&&(a=[2&a[0],r.value]),a[0]){case 0:case 1:r=a;break;case 4:return i.label++,{value:a[1],done:!1};case 5:i.label++,o=a[1],a=[0];continue;case 7:a=i.ops.pop(),i.trys.pop();continue;default:if(!((r=(r=i.trys).length>0&&r[r.length-1])||6!==a[0]&&2!==a[0])){i=0;continue}if(3===a[0]&&(!r||a[1]>r[0]&&a[1]<r[3])){i.label=a[1];break}if(6===a[0]&&i.label<r[1]){i.label=r[1],r=a;break}if(r&&i.label<r[2]){i.label=r[2],i.ops.push(a);break}r[2]&&i.ops.pop(),i.trys.pop();continue}a=t.call(e,i)}catch(e){a=[6,e],o=0}finally{n=r=0}if(5&a[0])throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}([a,c])}}}(this,(function(r){switch(r.label){case 0:return"add"!==e?[3,3]:[4,u()];case 1:return t=r.sent(),[4,a()];case 2:return r.sent(),n=P.getState().googleAccounts,(o=null==n?void 0:n.find((function(e){return e.token.access_token===t.access_token})))&&c(o.googleEmail),[2];case 3:return c(e),[2]}}))},new((o=void 0)||(o=Promise))((function(e,s){function i(e){try{c(r.next(e))}catch(e){s(e)}}function a(e){try{c(r.throw(e))}catch(e){s(e)}}function c(t){var n;t.done?e(t.value):(n=t.value,n instanceof o?n:new o((function(e){e(n)}))).then(i,a)}c((r=r.apply(t,n||[])).next())}));var t,n,o,r},tooltip:(0,r.__)("The Google account to create a new sheet under or to select an existing sheet from."),disabled:void 0===s,placeholder:void 0===s?(0,r.__)("Loading…","gp-google-sheets"):(0,r.__)("Select an Account","gp-google-sheets"),options:[{text:(0,r.__)("Actions","gp-google-sheets"),options:[{text:(0,r.__)("Authorize New Account","gp-google-sheets"),value:"add"}]},{text:(0,r.__)("Authorized Accounts","gp-google-sheets"),options:null!==(t=null==s?void 0:s.map((function(e){return{text:e.googleEmail,value:e.googleEmail}})))&&void 0!==t?t:[]}]})},W=function(){var t=P.use.googleAccount(),o=P.use.notices(),s=P.use.googleSheetUrl(),a=P.use.googleSpreadsheetId(),c=P.use.googleSheetId(),u=P.use.setGoogleSheetId(),l=P.use.connected(),d=P.use.googleErrorMessage(),g=P((function(e){var t;if(e.googleSpreadsheetId)return null===(t=e.sheets)||void 0===t?void 0:t[e.googleSpreadsheetId]}));return(0,n.useEffect)((function(){var e;if(void 0!==a&&"add"!==a||!t)if(a){if((0,L.fh)(),"select"===a||""===c||void 0===c||"string"==typeof g||!s)return;(0,L.$_)({sheetId:c,sheetName:null===(e=null==g?void 0:g.find((function(e){return e.id===c})))||void 0===e?void 0:e.title,sheetUrl:s})}else s&&!d||(0,L.fh)();else(0,L.p0)()}),[s,a,c,t,g,d]),(0,n.useEffect)((function(){var e=document.querySelector("input#google_sheet_url"),t=document.querySelector("input#google_sheet_id");e.value=null!=s?s:"",t.value=null!=c?c:""}),[s,c]),l?(0,e.jsxs)(n.Fragment,{children:[(0,e.jsx)(U,{notices:o}),(0,e.jsx)(C,{})]}):(0,e.jsxs)(n.Fragment,{children:[(0,e.jsx)(U,{notices:o}),(0,e.jsx)(K,{}),t&&(0,e.jsxs)(n.Fragment,{children:[(0,e.jsx)(G,{}),a&&"select"!==a&&"add"!==a&&(0,e.jsx)("a",{href:s,target:"_blank",rel:"noreferrer",style:{marginBottom:10,display:"inline-block"},children:(0,r.__)("View Spreadsheet","gp-google-sheets")}),a&&"select"!==a&&"add"!==a&&(0,e.jsx)(i,{name:"google_sheet_id_selector",label:"Sheet",value:null!=c?c:"",onChange:u,tooltip:(0,r.__)("Select the specific sheet in the spreadsheet you would like to store Gravity Forms entries in."),disabled:void 0===g,placeholder:void 0===g?(0,r.__)("Loading…","gp-google-sheets"):(0,r.__)("Select a Sheet","gp-google-sheets"),options:"object"==typeof g?g.map((function(e){return{text:e.title,value:e.id}})):[]})]})]})},B=window.wp.hooks;var z=document.querySelector("#gform-settings-section-google-sheets-settings .gform-settings-panel__content");"function"==typeof t.createRoot?(0,t.createRoot)(z).render((0,e.jsx)(W,{})):(0,t.render)((0,e.jsx)(W,{}),z),(0,B.addFilter)("i18n.gettext","gp-google-sheets/override-generic-map-column-labels",(function(e,t,n){return"Select a Field"===t?(0,r.__)("Select a Column","gp-google-sheets"):"Add Custom Key"===t?(0,r.__)("Add New Column","gp-google-sheets"):e}))})()})();
//# sourceMappingURL=gp-google-sheets-settings-feed.js.map